<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 380" font-family="system-ui, sans-serif">
  <defs>
    <marker id="a37" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
    <marker id="a37b" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3b82f6"/>
    </marker>
  </defs>
  <rect width="800" height="380" rx="12" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
  <text x="400" y="28" text-anchor="middle" font-size="16" font-weight="700" fill="#0f172a">データフロー全体像</text>

  <!-- Browser -->
  <rect x="30" y="50" width="200" height="300" rx="10" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5"/>
  <text x="130" y="72" text-anchor="middle" font-size="12" font-weight="700" fill="#475569">Browser (Client)</text>

  <rect x="45" y="85" width="170" height="30" rx="6" fill="#f0fdf4" stroke="#22c55e" stroke-width="1"/>
  <text x="130" y="105" text-anchor="middle" font-size="9" fill="#166534">useVoiceCapture</text>

  <rect x="45" y="125" width="170" height="30" rx="6" fill="#eff6ff" stroke="#3b82f6" stroke-width="1"/>
  <text x="130" y="145" text-anchor="middle" font-size="9" fill="#1e40af">useBattleEngine</text>

  <rect x="45" y="165" width="170" height="30" rx="6" fill="#fef2f2" stroke="#ef4444" stroke-width="1"/>
  <text x="130" y="185" text-anchor="middle" font-size="9" fill="#991b1b">useAIOpponent</text>

  <rect x="45" y="205" width="170" height="30" rx="6" fill="#fdf4ff" stroke="#a855f7" stroke-width="1"/>
  <text x="130" y="225" text-anchor="middle" font-size="9" fill="#6b21a8">useCommentary</text>

  <rect x="45" y="245" width="170" height="30" rx="6" fill="#fffbeb" stroke="#f59e0b" stroke-width="1"/>
  <text x="130" y="265" text-anchor="middle" font-size="9" fill="#92400e">VFX Components</text>

  <rect x="45" y="285" width="170" height="30" rx="6" fill="#0f172a"/>
  <text x="130" y="305" text-anchor="middle" font-size="9" fill="#22d3ee">Web Audio API</text>

  <!-- Next.js API -->
  <rect x="310" y="50" width="180" height="300" rx="10" fill="#eff6ff" stroke="#3b82f6" stroke-width="2"/>
  <text x="400" y="72" text-anchor="middle" font-size="12" font-weight="700" fill="#1e40af">Next.js API Routes</text>

  <rect x="325" y="90" width="150" height="25" rx="5" fill="white" stroke="#bfdbfe" stroke-width="1"/>
  <text x="400" y="107" text-anchor="middle" font-size="8" fill="#475569">/api/voice/analyze</text>

  <rect x="325" y="125" width="150" height="25" rx="5" fill="white" stroke="#bfdbfe" stroke-width="1"/>
  <text x="400" y="142" text-anchor="middle" font-size="8" fill="#475569">/api/ai-opponent/attack</text>

  <rect x="325" y="160" width="150" height="25" rx="5" fill="white" stroke="#bfdbfe" stroke-width="1"/>
  <text x="400" y="177" text-anchor="middle" font-size="8" fill="#475569">/api/commentary/live</text>

  <rect x="325" y="195" width="150" height="25" rx="5" fill="white" stroke="#bfdbfe" stroke-width="1"/>
  <text x="400" y="212" text-anchor="middle" font-size="8" fill="#475569">/api/kaiju/generate</text>

  <!-- Gemini -->
  <rect x="570" y="50" width="200" height="300" rx="10" fill="#fef2f2" stroke="#ef4444" stroke-width="2"/>
  <text x="670" y="72" text-anchor="middle" font-size="12" font-weight="700" fill="#991b1b">Gemini API</text>

  <rect x="585" y="90" width="170" height="25" rx="5" fill="white" stroke="#fecaca" stroke-width="1"/>
  <text x="670" y="107" text-anchor="middle" font-size="8" fill="#475569">gemini-3-flash (分析)</text>

  <rect x="585" y="125" width="170" height="25" rx="5" fill="white" stroke="#fecaca" stroke-width="1"/>
  <text x="670" y="142" text-anchor="middle" font-size="8" fill="#475569">gemini-3-flash (対戦)</text>

  <rect x="585" y="160" width="170" height="25" rx="5" fill="white" stroke="#fecaca" stroke-width="1"/>
  <text x="670" y="177" text-anchor="middle" font-size="8" fill="#475569">gemini-2.5-flash-tts</text>

  <rect x="585" y="195" width="170" height="25" rx="5" fill="white" stroke="#fecaca" stroke-width="1"/>
  <text x="670" y="212" text-anchor="middle" font-size="8" fill="#475569">imagen-4.0-generate</text>

  <!-- Arrows Client → API -->
  <line x1="235" y1="100" x2="320" y2="100" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#a37b)"/>
  <line x1="235" y1="180" x2="320" y2="137" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#a37b)"/>
  <line x1="235" y1="220" x2="320" y2="172" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#a37b)"/>

  <!-- Arrows API → Gemini -->
  <line x1="480" y1="102" x2="580" y2="102" stroke="#ef4444" stroke-width="1.5" marker-end="url(#a37)"/>
  <line x1="480" y1="137" x2="580" y2="137" stroke="#ef4444" stroke-width="1.5" marker-end="url(#a37)"/>
  <line x1="480" y1="172" x2="580" y2="172" stroke="#ef4444" stroke-width="1.5" marker-end="url(#a37)"/>
  <line x1="480" y1="207" x2="580" y2="207" stroke="#ef4444" stroke-width="1.5" marker-end="url(#a37)"/>

  <text x="400" y="370" text-anchor="middle" font-size="10" fill="#94a3b8">Client → Next.js API Route → Gemini API の3層構造</text>
</svg>