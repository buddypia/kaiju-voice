<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 800" font-family="'Nunito', 'Quicksand', system-ui, sans-serif">
  <defs>
    <linearGradient id="bg37" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#fdfbfb"/>
      <stop offset="100%" stop-color="#ebedee"/>
    </linearGradient>
    <path id="blob-c1-37" d="M 50,-80 C 100,-90 120,-30 110,20 C 100,80 50,110 -20,100 C -90,90 -120,30 -100,-30 C -80,-80 -10,-70 50,-80 Z"/>
    <path id="blob-c2-37" d="M 60,-70 C 110,-60 120,0 90,50 C 60,100 -10,120 -60,90 C -110,60 -120,-10 -90,-60 C -60,-100 10,-80 60,-70 Z"/>
    <path id="blob-c3-37" d="M 30,-90 C 90,-80 110,-20 100,40 C 90,100 20,110 -40,90 C -100,70 -110,10 -80,-40 C -50,-90 -20,-100 30,-90 Z"/>
    <path id="blob-c4-37" d="M 80,-60 C 120,-30 110,40 70,80 C 30,120 -40,110 -80,70 C -120,30 -110,-40 -70,-80 C -30,-120 40,-90 80,-60 Z"/>
    <path id="blob-c5-37" d="M 40,-85 C 95,-75 115,-15 105,35 C 95,85 35,115 -25,95 C -85,75 -115,15 -95,-45 C -75,-85 -15,-95 40,-85 Z"/>
    <path id="blob-c6-37" d="M 70,-65 C 115,-45 120,10 95,55 C 65,105 -5,115 -55,85 C -105,55 -115,-15 -85,-65 C -55,-105 25,-85 70,-65 Z"/>
    <path id="blob-hub-37" d="M 90,-120 C 150,-100 160,-20 140,50 C 120,120 40,160 -40,140 C -120,120 -160,40 -130,-30 C -100,-100 -10,-140 90,-120 Z"/>
  </defs>

  <rect width="1400" height="800" fill="url(#bg37)"/>

  <!-- Title -->
  <text x="700" y="70" text-anchor="middle" font-size="46" font-weight="800" fill="#334155">データフロー全体像</text>
  <text x="700" y="105" text-anchor="middle" font-size="22" font-weight="600" fill="#64748b">Client → Next.js API Route → Gemini API の3層構造</text>

  <!-- === Column 1: Browser (Client) === -->
  <g transform="translate(240, 400)">
    <use href="#blob-hub-37" fill="#bfdbfe" transform="scale(1.8)"/>
  </g>
  <text x="240" y="175" text-anchor="middle" font-size="24" font-weight="800" fill="#1e293b">Browser (Client)</text>

  <!-- Client sub-blobs -->
  <g transform="translate(170, 280)">
    <use href="#blob-c1-37" fill="#bbf7d0" transform="scale(0.55)"/>
  </g>
  <text x="170" y="285" text-anchor="middle" font-size="14" font-weight="600" fill="#166534">useVoiceCapture</text>

  <g transform="translate(310, 280)">
    <use href="#blob-c2-37" fill="#bfdbfe" transform="scale(0.55)"/>
  </g>
  <text x="310" y="285" text-anchor="middle" font-size="14" font-weight="600" fill="#1e40af">useBattleEngine</text>

  <g transform="translate(170, 380)">
    <use href="#blob-c3-37" fill="#fbcfe8" transform="scale(0.55)"/>
  </g>
  <text x="170" y="385" text-anchor="middle" font-size="14" font-weight="600" fill="#991b1b">useAIOpponent</text>

  <g transform="translate(310, 380)">
    <use href="#blob-c4-37" fill="#e9d5ff" transform="scale(0.55)"/>
  </g>
  <text x="310" y="385" text-anchor="middle" font-size="14" font-weight="600" fill="#6b21a8">useCommentary</text>

  <g transform="translate(170, 480)">
    <use href="#blob-c5-37" fill="#fed7aa" transform="scale(0.55)"/>
  </g>
  <text x="170" y="485" text-anchor="middle" font-size="14" font-weight="600" fill="#92400e">VFX Components</text>

  <g transform="translate(310, 480)">
    <use href="#blob-c6-37" fill="#fef08a" transform="scale(0.55)"/>
  </g>
  <text x="310" y="485" text-anchor="middle" font-size="14" font-weight="600" fill="#854d0e">Web Audio API</text>

  <!-- === Column 2: Next.js API Routes === -->
  <g transform="translate(700, 400)">
    <use href="#blob-hub-37" fill="#bbf7d0" transform="scale(1.8)"/>
  </g>
  <text x="700" y="175" text-anchor="middle" font-size="24" font-weight="800" fill="#1e293b">Next.js API Routes</text>

  <g transform="translate(640, 300)">
    <use href="#blob-c1-37" fill="#bbf7d0" transform="scale(0.5)"/>
  </g>
  <text x="640" y="305" text-anchor="middle" font-size="13" font-weight="600" fill="#166534">/api/voice/analyze</text>

  <g transform="translate(760, 300)">
    <use href="#blob-c2-37" fill="#bbf7d0" transform="scale(0.5)"/>
  </g>
  <text x="760" y="305" text-anchor="middle" font-size="13" font-weight="600" fill="#166534">/api/ai-opponent/attack</text>

  <g transform="translate(640, 400)">
    <use href="#blob-c3-37" fill="#bbf7d0" transform="scale(0.5)"/>
  </g>
  <text x="640" y="405" text-anchor="middle" font-size="13" font-weight="600" fill="#166534">/api/commentary/live</text>

  <g transform="translate(760, 400)">
    <use href="#blob-c4-37" fill="#bbf7d0" transform="scale(0.5)"/>
  </g>
  <text x="760" y="405" text-anchor="middle" font-size="13" font-weight="600" fill="#166534">/api/kaiju/generate</text>

  <!-- === Column 3: Gemini API === -->
  <g transform="translate(1160, 400)">
    <use href="#blob-hub-37" fill="#fbcfe8" transform="scale(1.8)"/>
  </g>
  <text x="1160" y="175" text-anchor="middle" font-size="24" font-weight="800" fill="#1e293b">Gemini API</text>

  <g transform="translate(1100, 300)">
    <use href="#blob-c5-37" fill="#fbcfe8" transform="scale(0.5)"/>
  </g>
  <text x="1100" y="305" text-anchor="middle" font-size="13" font-weight="600" fill="#991b1b">gemini-3-flash (分析)</text>

  <g transform="translate(1220, 300)">
    <use href="#blob-c6-37" fill="#fbcfe8" transform="scale(0.5)"/>
  </g>
  <text x="1220" y="305" text-anchor="middle" font-size="13" font-weight="600" fill="#991b1b">gemini-3-flash (対戦)</text>

  <g transform="translate(1100, 400)">
    <use href="#blob-c1-37" fill="#fbcfe8" transform="scale(0.5)"/>
  </g>
  <text x="1100" y="405" text-anchor="middle" font-size="13" font-weight="600" fill="#991b1b">gemini-2.5-flash-tts</text>

  <g transform="translate(1220, 400)">
    <use href="#blob-c2-37" fill="#fbcfe8" transform="scale(0.5)"/>
  </g>
  <text x="1220" y="405" text-anchor="middle" font-size="13" font-weight="600" fill="#991b1b">imagen-4.0-generate</text>

  <!-- Connectors: Client -> API -->
  <path d="M 400,340 C 460,330 520,320 580,330" stroke="#94a3b8" stroke-width="4" stroke-dasharray="12 12" stroke-linecap="round" fill="none"/>
  <path d="M 400,440 C 460,430 520,420 580,430" stroke="#94a3b8" stroke-width="4" stroke-dasharray="12 12" stroke-linecap="round" fill="none"/>

  <!-- Connectors: API -> Gemini -->
  <path d="M 830,340 C 900,330 960,320 1040,330" stroke="#94a3b8" stroke-width="4" stroke-dasharray="12 12" stroke-linecap="round" fill="none"/>
  <path d="M 830,440 C 900,430 960,420 1040,430" stroke="#94a3b8" stroke-width="4" stroke-dasharray="12 12" stroke-linecap="round" fill="none"/>

  <!-- Column labels (numbered) -->
  <circle cx="130" cy="170" r="24" fill="#3b82f6"/>
  <text x="130" y="180" text-anchor="middle" font-size="32" font-weight="900" fill="#ffffff">1</text>

  <circle cx="590" cy="170" r="24" fill="#22c55e"/>
  <text x="590" y="180" text-anchor="middle" font-size="32" font-weight="900" fill="#ffffff">2</text>

  <circle cx="1050" cy="170" r="24" fill="#ec4899"/>
  <text x="1050" y="180" text-anchor="middle" font-size="32" font-weight="900" fill="#ffffff">3</text>

  <!-- Footer -->
  <rect x="320" y="710" width="760" height="50" rx="30" fill="white"/>
  <text x="700" y="740" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">Client → Next.js API Route → Gemini API の3層構造</text>
</svg>