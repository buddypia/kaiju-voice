<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 800" font-family="'Nunito', 'Quicksand', system-ui, sans-serif">
  <defs>
    <linearGradient id="bg41" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#fdfbfb"/>
      <stop offset="100%" stop-color="#ebedee"/>
    </linearGradient>
    <path id="blob-c1" d="M 50,-80 C 100,-90 120,-30 110,20 C 100,80 50,110 -20,100 C -90,90 -120,30 -100,-30 C -80,-80 -10,-70 50,-80 Z"/>
    <path id="blob-c2" d="M 60,-70 C 110,-60 120,0 90,50 C 60,100 -10,120 -60,90 C -110,60 -120,-10 -90,-60 C -60,-100 10,-80 60,-70 Z"/>
    <path id="blob-c3" d="M 30,-90 C 90,-80 110,-20 100,40 C 90,100 20,110 -40,90 C -100,70 -110,10 -80,-40 C -50,-90 -20,-100 30,-90 Z"/>
    <path id="blob-c4" d="M 80,-60 C 120,-30 110,40 70,80 C 30,120 -40,110 -80,70 C -120,30 -110,-40 -70,-80 C -30,-120 40,-90 80,-60 Z"/>
    <path id="blob-c5" d="M 40,-85 C 95,-75 115,-15 105,35 C 95,85 35,115 -25,95 C -85,75 -115,15 -95,-45 C -75,-85 -15,-95 40,-85 Z"/>
    <path id="blob-hub" d="M 90,-120 C 150,-100 160,-20 140,50 C 120,120 40,160 -40,140 C -120,120 -160,40 -130,-30 C -100,-100 -10,-140 90,-120 Z"/>
  </defs>

  <!-- Background -->
  <rect width="1400" height="800" fill="url(#bg41)"/>

  <!-- Title -->
  <text x="700" y="70" text-anchor="middle" font-size="46" font-weight="800" fill="#334155">AbortController</text>
  <text x="700" y="105" text-anchor="middle" font-size="22" font-weight="600" fill="#64748b">プリフェッチの安全な中断パターン</text>

  <!-- Step 1: prefetchAIAttack() -->
  <g transform="translate(200, 300)">
    <use href="#blob-c4" transform="scale(1.4)" fill="#bbf7d0"/>
    <circle cx="0" cy="-65" r="28" fill="#22c55e"/>
    <text x="0" y="-57" text-anchor="middle" font-size="42" font-weight="900" fill="#ffffff">1</text>
    <text x="0" y="-10" text-anchor="middle" font-size="24" font-weight="800" fill="#1e293b">prefetchAIAttack()</text>
    <text x="0" y="22" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">new AbortController()</text>
    <text x="0" y="48" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">を生成して中断制御開始</text>
  </g>

  <!-- Connector 1->2 -->
  <path d="M 330,300 C 390,280 430,280 490,300" stroke="#94a3b8" stroke-width="4" stroke-dasharray="12 12" stroke-linecap="round" fill="none"/>

  <!-- Step 2: fetch with signal -->
  <g transform="translate(600, 280)">
    <use href="#blob-c2" transform="scale(1.5)" fill="#bfdbfe"/>
    <circle cx="0" cy="-70" r="28" fill="#3b82f6"/>
    <text x="0" y="-62" text-anchor="middle" font-size="42" font-weight="900" fill="#ffffff">2</text>
    <text x="0" y="-15" text-anchor="middle" font-size="24" font-weight="800" fill="#1e293b">fetch(url, ...)</text>
    <text x="0" y="18" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">signal: controller.signal</text>
    <text x="0" y="45" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">シグナルで中断を監視</text>
  </g>

  <!-- Connector 2->3 (success) -->
  <path d="M 740,250 C 810,210 880,210 960,230" stroke="#22c55e" stroke-width="4" stroke-dasharray="12 12" stroke-linecap="round" fill="none"/>

  <!-- Step 3: Success path -->
  <g transform="translate(1080, 230)">
    <use href="#blob-c1" transform="scale(1.3)" fill="#bbf7d0"/>
    <circle cx="0" cy="-55" r="28" fill="#22c55e"/>
    <text x="0" y="-47" text-anchor="middle" font-size="42" font-weight="900" fill="#ffffff">3</text>
    <text x="0" y="-5" text-anchor="middle" font-size="24" font-weight="800" fill="#1e293b">成功</text>
    <text x="0" y="28" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">prefetchedRef に</text>
    <text x="0" y="50" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">キャッシュ保存</text>
  </g>

  <!-- Connector 2->4 (abort) -->
  <path d="M 740,330 C 810,370 880,380 960,370" stroke="#ec4899" stroke-width="4" stroke-dasharray="12 12" stroke-linecap="round" fill="none"/>

  <!-- Step 4: Abort path -->
  <g transform="translate(1080, 400)">
    <use href="#blob-c3" transform="scale(1.3)" fill="#fbcfe8"/>
    <circle cx="0" cy="-55" r="28" fill="#ec4899"/>
    <text x="0" y="-47" text-anchor="middle" font-size="42" font-weight="900" fill="#ffffff">4</text>
    <text x="0" y="-5" text-anchor="middle" font-size="24" font-weight="800" fill="#1e293b">中断 / 失敗</text>
    <text x="0" y="28" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">catch で捕捉し</text>
    <text x="0" y="50" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">エラーを無視</text>
  </g>

  <!-- Step 5: Abort trigger -->
  <g transform="translate(400, 560)">
    <use href="#blob-c5" transform="scale(1.6)" fill="#fed7aa"/>
    <circle cx="0" cy="-70" r="28" fill="#f97316"/>
    <text x="0" y="-62" text-anchor="middle" font-size="42" font-weight="900" fill="#ffffff">5</text>
    <text x="0" y="-15" text-anchor="middle" font-size="24" font-weight="800" fill="#1e293b">中断タイミング</text>
    <text x="0" y="18" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">ゲーム終了時 / ページ遷移時</text>
    <text x="0" y="42" text-anchor="middle" font-size="16" font-weight="600" fill="#475569">新しいプリフェッチ開始時</text>
    <text x="0" y="72" text-anchor="middle" font-size="16" font-weight="600" fill="#f97316">controller.abort()</text>
  </g>

  <!-- Connector 5->2 -->
  <path d="M 530,520 C 580,470 590,400 600,360" stroke="#f97316" stroke-width="4" stroke-dasharray="12 12" stroke-linecap="round" fill="none"/>

  <!-- Hub: fire-and-forget -->
  <g transform="translate(900, 600)">
    <use href="#blob-hub" transform="scale(1.2)" fill="#8b5cf6"/>
    <text x="0" y="-20" text-anchor="middle" font-size="32" font-weight="800" fill="#ffffff">fire-and-forget</text>
    <text x="0" y="20" text-anchor="middle" font-size="18" font-weight="600" fill="#ffffff" opacity="0.9">成功 → キャッシュ</text>
    <text x="0" y="48" text-anchor="middle" font-size="18" font-weight="600" fill="#ffffff" opacity="0.9">失敗 → 無視</text>
  </g>

  <!-- Footer -->
  <rect x="350" y="740" width="700" height="44" rx="30" fill="#ffffff" opacity="0.9"/>
  <text x="700" y="768" text-anchor="middle" font-size="18" font-weight="600" fill="#64748b">プリフェッチは「あれば便利」-- 失敗してもライブ生成にフォールバック</text>
</svg>