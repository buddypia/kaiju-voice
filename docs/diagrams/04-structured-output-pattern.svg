<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 300" font-family="system-ui, sans-serif">
  <defs>
    <marker id="arrow4" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
    <marker id="arrow4d" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3b82f6"/>
    </marker>
  </defs>
  <rect width="800" height="300" rx="12" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
  <text x="400" y="30" text-anchor="middle" font-size="16" font-weight="700" fill="#0f172a">Structured Output パターン — Zod SSOT</text>

  <!-- Zod Schema (center, SSOT) -->
  <rect x="280" y="55" width="240" height="80" rx="10" fill="#fdf4ff" stroke="#a855f7" stroke-width="2.5"/>
  <text x="400" y="80" text-anchor="middle" font-size="13" font-weight="700" fill="#6b21a8">Zod Schema (SSOT)</text>
  <text x="400" y="100" text-anchor="middle" font-size="10" fill="#7c3aed" font-family="monospace">z.object({ intensity: z.number(), ... })</text>
  <text x="400" y="118" text-anchor="middle" font-size="10" fill="#94a3b8">Single Source of Truth</text>

  <!-- Arrow to JSON Schema -->
  <line x1="300" y1="140" x2="150" y2="185" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrow4d)"/>
  <text x="200" y="160" text-anchor="middle" font-size="10" fill="#3b82f6">toJSONSchema()</text>

  <!-- Arrow to TypeScript type -->
  <line x1="400" y1="140" x2="400" y2="185" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrow4d)"/>
  <text x="460" y="165" font-size="10" fill="#3b82f6">z.infer&lt;typeof&gt;</text>

  <!-- Arrow to Runtime validation -->
  <line x1="500" y1="140" x2="650" y2="185" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrow4d)"/>
  <text x="610" y="160" text-anchor="middle" font-size="10" fill="#3b82f6">.parse()</text>

  <!-- JSON Schema -->
  <rect x="40" y="190" width="200" height="70" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="140" y="215" text-anchor="middle" font-size="12" font-weight="600" fill="#1e40af">JSON Schema</text>
  <text x="140" y="235" text-anchor="middle" font-size="10" fill="#64748b">→ Gemini API に渡す</text>
  <text x="140" y="250" text-anchor="middle" font-size="10" fill="#64748b">responseJsonSchema</text>

  <!-- TypeScript Type -->
  <rect x="290" y="190" width="220" height="70" rx="8" fill="#f0fdf4" stroke="#22c55e" stroke-width="1.5"/>
  <text x="400" y="215" text-anchor="middle" font-size="12" font-weight="600" fill="#166534">TypeScript 型</text>
  <text x="400" y="235" text-anchor="middle" font-size="10" fill="#64748b">→ コード全体で型安全</text>
  <text x="400" y="250" text-anchor="middle" font-size="10" fill="#64748b">VoiceAnalysis 型</text>

  <!-- Runtime Validation -->
  <rect x="560" y="190" width="200" height="70" rx="8" fill="#fef2f2" stroke="#ef4444" stroke-width="1.5"/>
  <text x="660" y="215" text-anchor="middle" font-size="12" font-weight="600" fill="#991b1b">ランタイム検証</text>
  <text x="660" y="235" text-anchor="middle" font-size="10" fill="#64748b">→ API応答をバリデート</text>
  <text x="660" y="250" text-anchor="middle" font-size="10" fill="#64748b">schema.parse(data)</text>

  <text x="400" y="288" text-anchor="middle" font-size="11" fill="#94a3b8">1つのZodスキーマから3つの成果物を自動導出 — 手動同期不要</text>
</svg>