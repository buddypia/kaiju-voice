<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 200" font-family="system-ui, sans-serif">
  <defs>
    <marker id="a27" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
  </defs>
  <rect width="800" height="200" rx="12" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
  <text x="400" y="28" text-anchor="middle" font-size="16" font-weight="700" fill="#0f172a">音声録音フロー</text>

  <rect x="20" y="60" width="110" height="65" rx="8" fill="#f0fdf4" stroke="#22c55e" stroke-width="2"/>
  <text x="75" y="88" text-anchor="middle" font-size="11" font-weight="600" fill="#166534">getUserMedia</text>
  <text x="75" y="108" text-anchor="middle" font-size="9" fill="#64748b">マイク許可取得</text>

  <line x1="135" y1="92" x2="160" y2="92" stroke="#64748b" stroke-width="1.5" marker-end="url(#a27)"/>

  <rect x="165" y="60" width="120" height="65" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="225" y="88" text-anchor="middle" font-size="11" font-weight="600" fill="#1e40af">MediaRecorder</text>
  <text x="225" y="108" text-anchor="middle" font-size="9" fill="#64748b">audio/webm 録音</text>

  <line x1="290" y1="92" x2="315" y2="92" stroke="#64748b" stroke-width="1.5" marker-end="url(#a27)"/>

  <rect x="320" y="60" width="100" height="65" rx="8" fill="#fdf4ff" stroke="#a855f7" stroke-width="1.5"/>
  <text x="370" y="88" text-anchor="middle" font-size="11" font-weight="600" fill="#6b21a8">Blob</text>
  <text x="370" y="108" text-anchor="middle" font-size="9" fill="#64748b">ondataavailable</text>

  <line x1="425" y1="92" x2="450" y2="92" stroke="#64748b" stroke-width="1.5" marker-end="url(#a27)"/>

  <rect x="455" y="60" width="100" height="65" rx="8" fill="#fffbeb" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="505" y="88" text-anchor="middle" font-size="11" font-weight="600" fill="#92400e">FileReader</text>
  <text x="505" y="108" text-anchor="middle" font-size="9" fill="#64748b">→ base64</text>

  <line x1="560" y1="92" x2="585" y2="92" stroke="#64748b" stroke-width="1.5" marker-end="url(#a27)"/>

  <rect x="590" y="60" width="180" height="65" rx="8" fill="#fef2f2" stroke="#ef4444" stroke-width="2"/>
  <text x="680" y="85" text-anchor="middle" font-size="11" font-weight="600" fill="#991b1b">POST /api/voice/analyze</text>
  <text x="680" y="105" text-anchor="middle" font-size="9" fill="#64748b">inlineData として送信</text>

  <!-- Timer -->
  <rect x="165" y="140" width="255" height="30" rx="6" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1"/>
  <rect x="165" y="140" width="255" height="30" rx="6" fill="#3b82f6" opacity="0.15"/>
  <text x="292" y="160" text-anchor="middle" font-size="10" font-weight="600" fill="#1e40af">RECORDING_DURATION_MS = 5000ms</text>

  <text x="400" y="190" text-anchor="middle" font-size="10" fill="#94a3b8">Web Speech API → WebM → base64 → Gemini inlineData</text>
</svg>