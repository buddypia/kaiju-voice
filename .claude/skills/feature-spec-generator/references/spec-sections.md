# SPEC ã‚»ã‚¯ã‚·ãƒ§ãƒ³è©³ç´°ã‚¬ã‚¤ãƒ‰

> Hackathon Project ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® Feature-First + Simplified Clean Architecture + React 19 + Zod ã«æœ€é©åŒ–ã•ã‚ŒãŸ SPEC ä½œæˆã‚¬ã‚¤ãƒ‰
>
> **v3.6 (2026-02-11)**: ç°¡ç´ åŒ– - éåº¦ãªæŠ½è±¡åŒ–ã‚’é™¤å»ã€Next.js/React/TypeScript ã«é©å¿œ
>
> - Â§0.4.0 Domain Model Overview (DDD ç”¨èª) é™¤å»
> - Â§0.4.5 Write Operations (CQRS Command æ˜ç´°) é™¤å»
> - Â§0.10 Eventing & Async Processing (ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°) é™¤å»
> - Â§0.2.3 State Transitions A~G ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ â†’ ç°¡å˜ãªé·ç§»ãƒ†ãƒ¼ãƒ–ãƒ«ã«çµ±åˆ
> - Â§5.1 Test Fixtures JSON â†’ ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªä¸€è¦§ã«ç°¡ç´ åŒ–

---

## æ ¸å¿ƒåŸå‰‡: Zero-Context AI é–‹ç™ºå¯èƒ½æ€§

> **ç›®æ¨™**: AI ãŒ SPEC æ–‡æ›¸ã®ã¿ã§å®Ÿè£…ã‚’é–‹å§‹ã§ãã‚‹ã“ã¨ (ã‚³ãƒ¼ãƒ‰æ¢ç´¢æœ€å°åŒ–)

ã“ã®ã‚¬ã‚¤ãƒ‰ã®å…¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®è³ªå•ã«ã€ŒYesã€ã§å›ç­”ã§ãã‚‹ã‚ˆã†è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™:

- AI ãŒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã©ã“ã«ç”Ÿæˆã™ã‚‹ã‹æ¨æ¸¬ãªã—ã«åˆ¤æ–­ã§ãã‚‹ã‹?
- AI ãŒãƒãƒ¼ãƒŸãƒ³ã‚°è¦å‰‡ã‚’æ¨æ¸¬ãªã—ã«å¾“ãˆã‚‹ã‹?
- AI ãŒãƒ‰ãƒ¡ã‚¤ãƒ³ç”¨èªã‚’æ­£ç¢ºã«ç†è§£ã§ãã‚‹ã‹?
- AI ãŒãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒã‚’æ¨æ¸¬ãªã—ã«å®Ÿè£…ã§ãã‚‹ã‹?
- AI ãŒ API ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã‚’æ­£ç¢ºã«æŠŠæ¡ã§ãã‚‹ã‹?
- AI ãŒã‚¨ãƒ©ãƒ¼å‡¦ç†æ–¹æ³•ã‚’æ˜ç¢ºã«æŠŠæ¡ã§ãã‚‹ã‹?
- AI ãŒæ€§èƒ½/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ã‚’æº€ãŸã›ã‚‹ã‹?
- AI ãŒãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ pseudocode ã§ç†è§£ã§ãã‚‹ã‹?
- AI ãŒãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ fixture ã¨ã—ã¦å†åˆ©ç”¨ã§ãã‚‹ã‹?
- AI ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¼åã‚’è¦å‰‡é€šã‚Šã«ç”Ÿæˆã§ãã‚‹ã‹?

---

## Tier ãƒ™ãƒ¼ã‚¹ SPEC (ä½œæ¥­åŠ¹ç‡æ€§è€ƒæ…®)

> **å•é¡Œ**: Full SPEC v3.0 ã¯å…¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒè©³ç´°ã§ä½œæˆã‚³ã‚¹ãƒˆãŒé«˜ã„
> **è§£æ±º**: ä½œæ¥­ãƒªã‚¹ã‚¯åº¦ (Tier) ã«å¿œã˜ã¦å¿…é ˆæ·±åº¦ã‚’å·®ç­‰é©ç”¨

### Tier åˆ¤å®šåŸºæº–

|    Tier    | ãƒªã‚¹ã‚¯åº¦    | è©²å½“æ¡ä»¶                                               |
| :--------: | ----------- | ------------------------------------------------------ |
| **Tier 1** | High Risk   | èªè¨¼/æ±ºæ¸ˆ/PIIã€DB ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿å½±éŸ¿     |
| **Tier 2** | Medium Risk | å¤–éƒ¨ APIã€è¤‡æ•°ç”»é¢çŠ¶æ…‹ã€ãƒ‡ãƒ¼ã‚¿åŒæœŸ                     |
| **Tier 3** | Low Risk    | å˜ä¸€ç”»é¢ UIã€ãƒ†ã‚­ã‚¹ãƒˆ/ã‚¹ã‚¿ã‚¤ãƒ«å¤‰æ›´ã€æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³å†åˆ©ç”¨ |

### Tier åˆ¥å¿…é ˆæ·±åº¦ (v3.6 ç°¡ç´ åŒ–)

| ã‚»ã‚¯ã‚·ãƒ§ãƒ³                       |  Tier 1 (Full)  | Tier 2 (Standard) |  Tier 3 (Lite)  |
| -------------------------------- | :-------------: | :---------------: | :-------------: |
| **Â§0.0 Project Context**         |     âœ… è©³ç´°     |      âœ… ç°¡ç•¥      |     ğŸ“ 1è¡Œ      |
| Â§0.1 Target Files                |     âœ… è©³ç´°     |      âœ… è©³ç´°      |     âœ… ç°¡ç•¥     |
| **Â§0.2.1 Core State**            |  âœ… å…¨ãƒ†ãƒ¼ãƒ–ãƒ«  |   âœ… å…¨ãƒ†ãƒ¼ãƒ–ãƒ«   |     âœ… ç°¡ç•¥     |
| **Â§0.2.2 Architecture Guidance** |  âœ… åŸºæº–+ä¾‹ç¤º   |    âœ… åŸºæº–ã®ã¿    | ğŸ“ "å˜ä¸€ Hook"  |
| **Â§0.2.3 State Transitions**     | âœ… é·ç§»ãƒ†ãƒ¼ãƒ–ãƒ« |  âœ… é·ç§»ãƒ†ãƒ¼ãƒ–ãƒ«  |   ğŸ“ ãƒ†ã‚­ã‚¹ãƒˆ   |
| Â§0.3 Error Handling              |     âœ… å…¨ä½“     |    âœ… ãƒ†ãƒ¼ãƒ–ãƒ«    |   ğŸ“ ãƒ†ã‚­ã‚¹ãƒˆ   |
| Â§0.4.1 Zod ã‚¹ã‚­ãƒ¼ãƒ              |     âœ… å…¨ä½“     |      âœ… å…¨ä½“      |  ğŸ“ ã¾ãŸã¯ N/A  |
| Â§0.4.2 DB ã‚¹ã‚­ãƒ¼ãƒ               |     âœ… å…¨ä½“     |      âœ… å…¨ä½“      |  ğŸ“ ã¾ãŸã¯ N/A  |
| **Â§0.5 API Contract**            |     âœ… å…¨ä½“     |      âœ… å…¨ä½“      |  ğŸ“ ã¾ãŸã¯ N/A  |
| **Â§0.6 NFR**                     |     âœ… è©³ç´°     |     âœ… æ¨™æº–å€¤     | ğŸ“ "ä¸€èˆ¬ CRUD"  |
| Â§0.7 AI Logic & Prompts          |   âœ… (AI æ™‚)    |    âœ… (AI æ™‚)     |    N/A è¨±å®¹     |
| Â§0.8 Safety & Guardrails         |   âœ… (AI æ™‚)    |    âœ… (AI æ™‚)     |    N/A è¨±å®¹     |
| **Â§0.9 Design Tokens**           |     âœ… è©³ç´°     |      âœ… ç°¡ç•¥      |  ğŸ“ "æ—¢å­˜ä½¿ç”¨"  |
| Â§1 æ¦‚è¦                          |       âœ…        |        âœ…         |       âœ…        |
| **Â§1.5 Screen Flow**             | âœ… ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ  |    âœ… ãƒ†ãƒ¼ãƒ–ãƒ«    |   ğŸ“ ãƒ†ã‚­ã‚¹ãƒˆ   |
| Â§2 FR                            |   âœ… BDD 5åˆ—    |    âœ… BDD 5åˆ—     |   âœ… BDD ç°¡ç•¥   |
| **Â§2.X Business Rules**          |  âœ… Pseudocode  |    âœ… ãƒ†ã‚­ã‚¹ãƒˆ    |     ğŸ“ ç°¡ç•¥     |
| Â§3 ä¾å­˜æ€§/ãƒªã‚¹ã‚¯                 |    âœ… Top 3     |     âœ… Top 3      |     ğŸ“ 1è¡Œ      |
| Â§4 ç”»é¢æ–‡æ›¸                      |     âœ… è©³ç´°     |      âœ… ç°¡ç•¥      |  ğŸ“ ã‚¹ã‚­ãƒƒãƒ—å¯  |
| **Â§5 æ¤œè¨¼ & ãƒ†ã‚¹ãƒˆ**             | âœ… ã‚·ãƒŠãƒªã‚ªä¸€è¦§ |      âœ… ç°¡ç•¥      |  ğŸ“ ã‚¹ã‚­ãƒƒãƒ—å¯  |
| **Â§6 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šç¾©**            |     âœ… è©³ç´°     |      âœ… ç°¡ç•¥      | ğŸ“ ã‚­ãƒ¼ä¸€è¦§ã®ã¿ |
| Â§7 å¤‰æ›´å±¥æ­´                      |       âœ…        |        âœ…         |       âœ…        |

**å‡¡ä¾‹**: âœ… å¿…é ˆ, ğŸ“ ç°¡ç•¥/ãƒ†ã‚­ã‚¹ãƒˆè¨±å®¹

### SPEC-Lite ä¾‹ç¤º (Tier 3)

```markdown
# 029: ã‚³ãƒ¼ãƒ‰å…¥åŠ› UI æ”¹å–„

> **çŠ¶æ…‹**: é€²è¡Œä¸­ (30%) | **å„ªå…ˆåº¦**: P2 | **ä¿®æ­£æ—¥**: 2026-02-11
> **SPEC ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v3.5 Lite (Tier 3)

---

## 0. AI å®Ÿè£…å¥‘ç´„

### 0.0 Project Context

æ—¢å­˜ code-input ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ‹¡å¼µã€æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ãªã—

### 0.1 Target Files

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | ç¯„å›² (Glob)                             | ä½œæ¥­ | æ¡ä»¶ |
| -------- | --------------------------------------- | :--: | ---- |
| UI       | `src/features/code-input/components/**` |  ğŸ”„  | -    |

### 0.2 State & Architecture

æ—¢å­˜ `useCodeInput` Hook å†åˆ©ç”¨ã€UI ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã¿å¤‰æ›´ (å˜ä¸€ Hook ç¶­æŒ)

### 0.3 Error Handling

æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ç¶­æŒ

### 0.4-0.8

**N/A** - æ—¢å­˜å®Ÿè£…å†åˆ©ç”¨

### 0.9 Design Tokens

æ—¢å­˜ãƒ†ãƒ¼ãƒä½¿ç”¨

---

## 1. æ¦‚è¦

ç›®æ¨™: ã‚³ãƒ¼ãƒ‰å…¥åŠ›ã‚¨ãƒªã‚¢ã®å¯èª­æ€§å‘ä¸Š (ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆè¿½åŠ )

---

## 2. æ©Ÿèƒ½è¦æ±‚äº‹é …

### FR-02901: ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆ

| AC  | Given          | When         | Then                   | è¦³æ¸¬ç‚¹                      |
| :-: | -------------- | ------------ | ---------------------- | --------------------------- |
| AC1 | ã‚³ãƒ¼ãƒ‰å…¥åŠ›çŠ¶æ…‹ | è¨€èªé¸æŠå¤‰æ›´ | å¯¾å¿œã™ã‚‹ãƒã‚¤ãƒ©ã‚¤ãƒˆé©ç”¨ | `language === 'typescript'` |

---

## 6. i18n

- `code_input_language_label`: "è¨€èª"
- `code_input_language_typescript`: "TypeScript"

---

## 7. å¤‰æ›´å±¥æ­´

| æ—¥ä»˜       | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´ |
| ---------- | ---------- | ---- |
| 2026-02-11 | v1.0       | åˆç¨¿ |
```

### ã„ã¤ SPEC-Lite ã‚’ä½¿ç”¨ã™ã‚‹ã‹?

| çŠ¶æ³                   | æ¨å¥¨                        |
| ---------------------- | --------------------------- |
| æ–°æ©Ÿèƒ½ã€API å«ã‚€       | **Full SPEC v3.5**          |
| æ—¢å­˜æ©Ÿèƒ½æ‹¡å¼µã€API å¤‰æ›´ | **Standard (Tier 2)**       |
| UI æ”¹å–„ã€ãƒã‚°ä¿®æ­£      | **SPEC-Lite (Tier 3)** è¨±å®¹ |

> **æ³¨æ„**: Tier èª¤åˆ¤æ™‚ AI å®Ÿè£…å“è³ªä½ä¸‹ã€‚ä¸ç¢ºå®Ÿãªã‚‰**ä¸Šä½ Tier**ã‚’é¸æŠ

---

## ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 0: AI å®Ÿè£…å¥‘ç´„ (å¿…é ˆ)

> **ç›®çš„**: AI ãŒå®Ÿè£…é–‹å§‹å‰ã«æŠŠæ¡ã™ã¹ãæ ¸å¿ƒæƒ…å ±ã‚’ä¸€ç›®ã§æä¾›
> **åŸå‰‡**: ã‚³ãƒ¼ãƒ‰ã‹ã‚‰æŠ½å‡ºå¯èƒ½ãªæƒ…å ±ã§ã‚‚ SPEC ã«è¦ç´„ã—ã¦ AI ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåé›†ã‚³ã‚¹ãƒˆã‚’å‰Šæ¸›

---

### 0.0 Project Context (v3.0 æ–°è¦)

> **ç›®çš„**: AI ãŒãƒãƒ¼ãƒŸãƒ³ã‚°ã€ç”¨èªã‚’æ¨æ¸¬ãªã—ã«åˆ¤æ–­ã§ãã‚‹ã‚ˆã†ã«
> **ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®**: AI ãŒæ—¢å­˜ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å‚ç…§ã—ã¦è‡ªå¾‹æ±ºå®š

#### 0.0.1 Naming Conventions

```markdown
#### 0.0.2 Naming Conventions

| å¯¾è±¡           | ãƒ‘ã‚¿ãƒ¼ãƒ³                         | ä¾‹ç¤º                             |
| -------------- | -------------------------------- | -------------------------------- |
| Custom Hook    | `use{Feature}`                   | `useCodeInput`                   |
| State å‹       | `{Feature}State`                 | `CodeInputState`                 |
| å‹å®šç¾©         | `{Entity}` ã¾ãŸã¯ `{Entity}Type` | `CodeSubmission`                 |
| ã‚¤ãƒ™ãƒ³ãƒˆ       | `on{Action}`                     | `onSubmitCode`, `onAnalyze`      |
| ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¼ | `{screen}_{element}_{state}`     | `code_input_submit_button_label` |
| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | `{Feature}{Role}` (PascalCase)   | `CodeInputPanel`, `QuizOption`   |
| API Route      | `/api/{feature}/{action}`        | `/api/analysis/analyze`          |
```

**ä½œæˆåŸå‰‡**:

- ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®æ—¢å­˜ã‚³ãƒ³ãƒ™ãƒ³ã‚·ãƒ§ãƒ³ã¨ä¸€è‡´ã™ã‚‹ã“ã¨
- AI ãŒãƒãƒ¼ãƒŸãƒ³ã‚°ã‚’æ¨æ¸¬ã—ãªã„ã‚ˆã†å…·ä½“çš„ãªä¾‹ç¤ºã‚’å«ã‚ã‚‹

#### 0.0.2 Glossary

```markdown
#### 0.0.2 Glossary

> **å‚ç…§**: [docs/glossary.md](../glossary.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ç”¨èªé›†
> ã“ã®æ©Ÿèƒ½ã§ä½¿ç”¨ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ç”¨èªã¯ glossary.md ã‚’å‚ç…§

**ã“ã®æ©Ÿèƒ½é–¢é€£ã®æ ¸å¿ƒç”¨èª**:

| ç”¨èª    | å®šç¾©   | ã‚³ãƒ¼ãƒ‰è¡¨ç¾    |
| ------- | ------ | ------------- |
| {Term1} | {å®šç¾©} | `{TypeName}`  |
| {Term2} | {å®šç¾©} | `{fieldName}` |

> â„¹ï¸ ç”¨èªè¿½åŠ ãŒå¿…è¦ãªå ´åˆã¯ glossary.md ã«å…ˆã«ç™»éŒ²ã—ã¦ã‹ã‚‰å‚ç…§
```

**ä½œæˆåŸå‰‡**:

- **SSOT**: `docs/glossary.md` ãŒçœŸå®Ÿã®åŸæ³‰
- SPEC ã§ã¯ã“ã®æ©Ÿèƒ½ã§ä½¿ç”¨ã™ã‚‹æ ¸å¿ƒç”¨èªã®ã¿æŠœç²‹
- æ–°ã—ã„ç”¨èªã¯ glossary.md ã«å…ˆã«ç™»éŒ²

---

### 0.1 Target Files (ç¯„å›²ãƒ™ãƒ¼ã‚¹)

> **v3.1 å¤‰æ›´**: å…·ä½“çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ä»£ã‚ã‚Šã« **Glob ãƒ‘ã‚¿ãƒ¼ãƒ³** ä½¿ç”¨
> **SSOT**: CONTEXT.json ã® `references.related_code` ãŒå®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ç®¡ç†

```markdown
| ãƒ¬ã‚¤ãƒ¤ãƒ¼  | ç¯„å›² (Glob)                             | ä½œæ¥­ | æ¡ä»¶          | å‚™è€ƒ                         |
| --------- | --------------------------------------- | :--: | ------------- | ---------------------------- |
| å‹å®šç¾©    | `src/features/code-input/types/**`      |  ğŸ†•  | -             | Zod ã‚¹ã‚­ãƒ¼ãƒ + TypeScript å‹ |
| Hook      | `src/features/code-input/hooks/**`      |  ğŸ†•  | -             | ã‚«ã‚¹ã‚¿ãƒ  Hook (çŠ¶æ…‹ç®¡ç†)     |
| API       | `src/features/code-input/api/**`        |  ğŸ†•  | -             | API å‘¼ã³å‡ºã—                 |
| UI        | `src/features/code-input/components/**` |  ğŸ†•  | -             | React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ         |
| Test      | `tests/unit/features/code-input/**`     |  ğŸ†•  | -             | å˜ä½“ãƒ†ã‚¹ãƒˆ                   |
| API Route | `src/app/api/analysis/**`               |  ğŸ†•  | AI åˆ†æé¸æŠæ™‚ | æ¡ä»¶ä»˜ã                     |
```

**ä½œæ¥­ã‚¿ã‚¤ãƒ—**:
| ã‚¢ã‚¤ã‚³ãƒ³ | æ„å‘³ |
|:------:|------|
| ğŸ†• | æ–°è¦ä½œæˆ |
| ğŸ”„ | æ—¢å­˜ä¿®æ­£ |
| âš¡ | æ¡ä»¶ä»˜ã (æ¡ä»¶åˆ—å‚ç…§) |

**ä½œæˆåŸå‰‡**:

- Glob ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ç¯„å›²æŒ‡å®š (`**`, `*` ä½¿ç”¨)
- **æ¡ä»¶ä»˜ããƒ•ã‚¡ã‚¤ãƒ«**ã¯æ¡ä»¶åˆ—ã«ãƒˆãƒªã‚¬ãƒ¼æ¡ä»¶æ˜ç¤º
- å…·ä½“çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã¯ CONTEXT.json ã® `references.related_code` å‚ç…§
- å®Ÿè£…å¾Œ CONTEXT.json æ›´æ–°ãŒ SSOT ç¶­æŒã®æ ¸å¿ƒ

**ä¾‹ç¤º: æ¡ä»¶ä»˜ããƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†**:

```markdown
| ãƒ¬ã‚¤ãƒ¤ãƒ¼  | ç¯„å›²                             | ä½œæ¥­ | æ¡ä»¶            | å‚™è€ƒ         |
| --------- | -------------------------------- | :--: | --------------- | ------------ |
| API Route | `src/app/api/analysis/**`        |  âš¡  | Option A é¸æŠæ™‚ | ã‚µãƒ¼ãƒãƒ¼åˆ†æ |
| Client    | `src/features/code-input/lib/**` |  âš¡  | Option B é¸æŠæ™‚ | ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç† |
```

â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ Option A ã‚’é¸æŠã™ã‚Œã° API Route ã®ã¿å®Ÿè£…

#### Â§0.1 â†” Â§0.4 äº¤å·®å‚ç…§æ¤œè¨¼ (v3.7 æ–°è¦)

> **ç›®çš„**: Data Schema(Â§0.4) ã§å®šç¾©ã—ãŸé …ç›®ãŒ Target Files(Â§0.1) ã«æ¼ã‚Œãªãåæ˜ ã•ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼
> **æ¤œè¨¼æ™‚ç‚¹**: SPEC ä½œæˆå®Œäº†å¾Œ Phase 4 æ¤œè¨¼æ®µéš

| Â§0.4 ã§å®šç¾©              | Â§0.1 ã«å¿…é ˆåæ˜       | æ¤œè¨¼ãƒ«ãƒ¼ãƒ«                                 |
| ------------------------ | -------------------- | ------------------------------------------ |
| Â§0.4.1 æ–°è¦ Zod ã‚¹ã‚­ãƒ¼ãƒ | `å‹å®šç¾©` ãƒ¬ã‚¤ãƒ¤ãƒ¼    | ã‚¹ã‚­ãƒ¼ãƒå®šç¾©æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹å¿…é ˆ             |
| Â§0.5 æ–°è¦ API Route      | `API Route` ãƒ¬ã‚¤ãƒ¤ãƒ¼ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®šç¾©æ™‚ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå¿…é ˆ |

**æ¼ã‚Œé˜²æ­¢ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**:

- [ ] Â§0.4.1 ã§ `AnalysisResultSchema` ã®ã‚ˆã†ãªæ–°è¦ã‚¹ã‚­ãƒ¼ãƒå®šç¾© â†’ Â§0.1 ã« `src/features/{domain}/types/{schema}.ts` è¿½åŠ 
- [ ] Â§0.5 ã§æ–°è¦ API Route å®šç¾© â†’ Â§0.1 ã« `src/app/api/{name}/route.ts` è¿½åŠ 

**ã‚ˆãç™ºç”Ÿã™ã‚‹æ¼ã‚Œãƒ‘ã‚¿ãƒ¼ãƒ³**:

```markdown
âŒ èª¤ã£ãŸä¾‹ (å‹å®šç¾©ãƒ¬ã‚¤ãƒ¤ãƒ¼æ¼ã‚Œ):
| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | ç¯„å›² | ä½œæ¥­ |
|---------|------|:----:|
| Hook | `src/features/analysis/hooks/**` | ğŸ†• | â† Hook ã®ã¿ã‚ã‚Š
| UI | `src/features/analysis/components/**` | ğŸ†• | â† å‹å®šç¾©ãƒ¬ã‚¤ãƒ¤ãƒ¼ãªã—!

Â§0.4.1 ã§ AnalysisResultSchema å®šç¾© â†’ å‹å®šç¾©ãƒ¬ã‚¤ãƒ¤ãƒ¼å¿…é ˆ!

âœ… æ­£ã—ã„ä¾‹:
| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | ç¯„å›² | ä½œæ¥­ |
|---------|------|:----:|
| å‹å®šç¾© | `src/features/analysis/types/**` | ğŸ†• | â† è¿½åŠ 
| Hook | `src/features/analysis/hooks/**` | ğŸ†• |
| UI | `src/features/analysis/components/**` | ğŸ†• |
```

---

### 0.2 State & Architecture (v3.5 æ”¹ç·¨)

> **v3.5 å¤‰æ›´**: å‡¦æ–¹çš„ãª Provider ãƒªã‚¹ãƒˆ â†’ **åŸå‰‡ãƒ™ãƒ¼ã‚¹ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³**ã«è»¢æ›
> **ç›®çš„**: AI ãŒæ©Ÿèƒ½è¤‡é›‘åº¦ã«åˆã‚ã›ã¦è‡ªå¾‹çš„ã«è¨­è¨ˆã—ã¤ã¤ã€ä¸€è²«ã—ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã†ã‚ˆã†ã«

---

#### 0.2.1 Core State (å¿…é ˆ)

> **ç›®çš„**: AI ãŒç®¡ç†ã™ã¹ã**æ ¸å¿ƒçŠ¶æ…‹è¦ç´ **ã‚’å®šç¾©
> **åŸå‰‡**: çŠ¶æ…‹æ§‹é€ ã¯æ˜ç¤ºã™ã‚‹ãŒã€å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«æ•°ã¯ AI ãŒ SRP åŸºæº–ã§æ±ºå®š

````markdown
#### 0.2.1 Core State

##### çŠ¶æ…‹è¦ç´ å®šç¾©

| çŠ¶æ…‹è¦ç´  | å‹                   | å¿…é ˆ | ç”¨é€”                                     | åˆæœŸå€¤   |
| -------- | -------------------- | :--: | ---------------------------------------- | -------- |
| `items`  | `CodeSubmission[]`   |  âœ…  | ãƒ‡ãƒ¼ã‚¿ä¸€è¦§                               | `[]`     |
| `status` | `ScreenStatus`       |  âœ…  | ç”»é¢çŠ¶æ…‹ (idle/loading/data/empty/error) | `'idle'` |
| `error`  | `AppError \| null`   |  âšª  | ã‚¨ãƒ©ãƒ¼æƒ…å ±                               | `null`   |
| `filter` | `CodeFilter \| null` |  âšª  | ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶                           | `null`   |

##### çŠ¶æ…‹ enum å®šç¾© (æ¨å¥¨)

```typescript
type ScreenStatus = 'idle' | 'loading' | 'data' | 'empty' | 'error';
```
````

##### æ´¾ç”ŸçŠ¶æ…‹ (Derived State)

| æ´¾ç”ŸçŠ¶æ…‹        | è¨ˆç®—å¼                                        | ç”¨é€”                   |
| --------------- | --------------------------------------------- | ---------------------- |
| `hasData`       | `status === 'data' && items.length > 0`       | ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºæ¡ä»¶         |
| `filteredItems` | `filter ? applyFilter(items, filter) : items` | ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¸ˆã¿ä¸€è¦§ |
| `itemCount`     | `filteredItems.length`                        | UI è¡¨ç¤ºç”¨              |

````

**Core State ä½œæˆåŸå‰‡**:
- **æ ¸å¿ƒçŠ¶æ…‹è¦ç´ **ã®ã¿å®šç¾© (å®Ÿè£…è©³ç´°ã§ã¯ãªã„)
- æ´¾ç”ŸçŠ¶æ…‹ã¯ Hook ã® `useMemo` ã§å®Ÿè£…
- çŠ¶æ…‹è¦ç´ ã®**åˆæœŸå€¤**ã‚’æ˜ç¤ºã—ã¦ AI ãŒãƒ†ã‚¹ãƒˆä½œæˆæ™‚ã«æ´»ç”¨

---

#### 0.2.2 Architecture Guidance (ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³)

> **ç›®çš„**: AI ãŒ **SRP (å˜ä¸€è²¬ä»»åŸå‰‡)** ã«å¾“ã„è‡ªå¾‹çš„ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†é›¢ã™ã‚‹ã‚ˆã†æ¡ˆå†…
> **æ ¸å¿ƒ**: å…·ä½“çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆä»£ã‚ã‚Šã«**åˆ†é›¢åŸºæº–**ã¨**ãƒãƒ¼ãƒŸãƒ³ã‚°è¦å‰‡**ã‚’æä¾›

```markdown
#### 0.2.2 Architecture Guidance

##### Hook åˆ†é›¢åŸºæº– (SRP åŸå‰‡)

| æ¡ä»¶ | æ¨å¥¨è¡Œå‹• | ä¾‹ç¤º |
|------|---------|------|
| ç”»é¢1ã¤ã€å˜ç´” CRUD | å˜ä¸€ Hook | `useCodeInput` |
| ç”»é¢2ã¤+ (ä¸€è¦§/è©³ç´°) | ç”»é¢åˆ¥ Hook åˆ†é›¢ | `useCodeList`, `useCodeDetail` |
| è¤‡é›‘ãªãƒ•ã‚©ãƒ¼ãƒ æ¤œè¨¼ | åˆ¥é€” Form Hook | `useCodeForm` |
| è¤‡æ•°ç”»é¢ã§çŠ¶æ…‹å…±æœ‰ | Context + Hook | `CodeInputProvider` + `useCodeInputContext` |

##### API åˆ†é›¢åŸºæº–

| æ¡ä»¶ | æ¨å¥¨è¡Œå‹• | ä¾‹ç¤º |
|------|---------|------|
| å˜ç´” API å‘¼ã³å‡ºã— | API é–¢æ•°1ã¤ | `analyzeCode()` |
| å¤–éƒ¨ API é€£æº (AI ç­‰) | å¤–éƒ¨ API åˆ¥åˆ†é›¢ | `analyzeCode()`, `generateQuiz()` |
| è¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ | ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹åˆ†é›¢ | `analysisService` |

##### ãƒãƒ¼ãƒŸãƒ³ã‚°è¦å‰‡ (å¿…é ˆæº–æ‹ )

| å¯¾è±¡ | ãƒ‘ã‚¿ãƒ¼ãƒ³ | ä¾‹ç¤º |
|------|---------|------|
| **Hook (ä¸€è¦§)** | `use{Feature}List` | `useCodeList` |
| **Hook (è©³ç´°)** | `use{Feature}Detail` | `useCodeDetail` |
| **Hook (ãƒ•ã‚©ãƒ¼ãƒ )** | `use{Feature}Form` | `useCodeForm` |
| **Hook (å˜ä¸€)** | `use{Feature}` | `useCodeInput` |
| **API é–¢æ•°** | `{action}{Feature}` | `analyzeCode`, `fetchExplanation` |
| **å‹å®šç¾©** | `{Feature}State` | `CodeInputState` |
| **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** | `{Feature}{Role}` | `CodeInputPanel`, `CodeInputForm` |

##### React ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

| çŠ¶æ³ | ãƒ‘ã‚¿ãƒ¼ãƒ³ | ç†ç”± |
|------|---------|------|
| ç”»é¢åˆ¥çŠ¶æ…‹ (åŸºæœ¬) | `useState` / `useReducer` | ãƒ¡ãƒ¢ãƒªç¯€ç´„ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆæ™‚è§£æ”¾ |
| ã‚¢ãƒ—ãƒªå…¨åŸŸçŠ¶æ…‹ (ãƒ†ãƒ¼ãƒç­‰) | `Context` + `useContext` | ã‚¢ãƒ—ãƒªçµ‚äº†ã¾ã§ç¶­æŒ |
| ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ (API ãƒ‡ãƒ¼ã‚¿) | `fetch` + `useState` / SWR | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç† |
| é«˜ã‚³ã‚¹ãƒˆè¨ˆç®— | `useMemo` | å†è¨ˆç®—é˜²æ­¢ |

##### AI è¨­è¨ˆæ±ºå®šãƒ•ãƒ­ãƒ¼

````

1. FR (æ©Ÿèƒ½è¦æ±‚äº‹é …) åˆ†æ
   â†“
2. ç”»é¢æ•°æŠŠæ¡ (Screen Flow å‚ç…§)
   â†“
3. Hook åˆ†é›¢è¦å¦æ±ºå®š
   â”œâ”€â”€ ç”»é¢1ã¤ + å˜ç´” â†’ å˜ä¸€ Hook
   â””â”€â”€ ç”»é¢2ã¤+ ã¾ãŸã¯è¤‡é›‘ â†’ åˆ†é›¢
   â†“
4. API åˆ†é›¢è¦å¦æ±ºå®š
   â”œâ”€â”€ å˜ç´” API â†’ å˜ä¸€é–¢æ•°
   â””â”€â”€ å¤–éƒ¨ API/è¤‡é›‘ãƒ­ã‚¸ãƒƒã‚¯ â†’ åˆ†é›¢
   â†“
5. ãƒãƒ¼ãƒŸãƒ³ã‚°è¦å‰‡é©ç”¨
   â†“
6. ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«æ±ºå®š (useState/useContext/useMemo)

```

```

**Architecture Guidance ä½œæˆåŸå‰‡**:

- **åˆ†é›¢åŸºæº–**ã‚’æ˜ç¢ºã«ã—ã¦ AI ãŒä¸€è²«ã—ãŸåˆ¤æ–­ãŒå¯èƒ½
- **ãƒãƒ¼ãƒŸãƒ³ã‚°è¦å‰‡**ã¯å¿…é ˆæº–æ‹  (ä¸€è²«æ€§ä¿è¨¼)
- **"ä¾‹ç¤º" ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯é¸æŠçš„** - è¤‡é›‘ãªæ©Ÿèƒ½ã§ã®ã¿è¿½åŠ 
- Tier åˆ¥ã«ç•°ãªã‚‹é©ç”¨:
  - Tier 3 (å˜ç´”): åˆ†é›¢åŸºæº–ã®ã¿å‚ç…§ã€å¤§éƒ¨åˆ†å˜ä¸€ Hook
  - Tier 1-2 (è¤‡é›‘): åˆ†é›¢åŸºæº– + å…·ä½“çš„ä¾‹ç¤ºæ¨å¥¨

##### Tier åˆ¥ Â§0.2.2 ä½œæˆæ·±åº¦

| é …ç›®           |  Tier 1 (Full)  | Tier 2 (Standard) |   Tier 3 (Lite)    |
| -------------- | :-------------: | :---------------: | :----------------: |
| Core State     |  âœ… å…¨ãƒ†ãƒ¼ãƒ–ãƒ«  |   âœ… å…¨ãƒ†ãƒ¼ãƒ–ãƒ«   |  âœ… ç°¡ç•¥ãƒ†ãƒ¼ãƒ–ãƒ«   |
| åˆ†é›¢åŸºæº–å‚ç…§   | âœ… + å…·ä½“çš„ä¾‹ç¤º |    âœ… åŸºæº–ã®ã¿    |   ğŸ“ "å˜ä¸€ Hook"   |
| ãƒãƒ¼ãƒŸãƒ³ã‚°è¦å‰‡ |     âœ… å…¨ä½“     |      âœ… å…¨ä½“      |      âœ… å…¨ä½“       |
| ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« |     âœ… è©³ç´°     |      âœ… åŸºæœ¬      | ğŸ“ "useState åŸºæœ¬" |

---

### 0.2.3 State Transitions (ç°¡ç´ åŒ–)

> **ç›®çš„**: AI ãŒçŠ¶æ…‹é·ç§»ã‚’æ­£ç¢ºã«ç†è§£ã™ã‚‹ã‚ˆã†æ ¸å¿ƒæƒ…å ±ã®ã¿æä¾›

````markdown
#### 0.2.3 State Transitions

##### çŠ¶æ…‹ä¸€è¦§

| çŠ¶æ…‹      | èª¬æ˜           |
| --------- | -------------- |
| `idle`    | åˆæœŸçŠ¶æ…‹       |
| `loading` | ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰ä¸­ |
| `data`    | ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºä¸­   |
| `empty`   | ãƒ‡ãƒ¼ã‚¿ãªã—     |
| `error`   | ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ     |

##### é·ç§»ãƒ†ãƒ¼ãƒ–ãƒ«

| From      | Event                  | To        | å‚™è€ƒ           |
| --------- | ---------------------- | --------- | -------------- |
| `idle`    | `load`                 | `loading` | ç”»é¢é€²å…¥æ™‚     |
| `loading` | `success (ãƒ‡ãƒ¼ã‚¿ã‚ã‚Š)` | `data`    | -              |
| `loading` | `success (ãƒ‡ãƒ¼ã‚¿ãªã—)` | `empty`   | -              |
| `loading` | `failure`              | `error`   | ã‚¨ãƒ©ãƒ¼ãƒ­ã‚®ãƒ³ã‚° |
| `data`    | `refresh`              | `loading` | -              |
| `error`   | `retry`                | `loading` | æœ€å¤§3å›        |

##### çŠ¶æ…‹ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ  (Mermaid)

```mermaid
stateDiagram-v2
    [*] --> Idle
    Idle --> Loading : load
    Loading --> Data : success (ãƒ‡ãƒ¼ã‚¿ã‚ã‚Š)
    Loading --> Empty : success (ãƒ‡ãƒ¼ã‚¿ãªã—)
    Loading --> Error : failure
    Data --> Loading : refresh
    Empty --> Loading : refresh
    Error --> Loading : retry
```
````

````

**ä½œæˆåŸå‰‡**:
- çŠ¶æ…‹ä¸€è¦§ã¨é·ç§»ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã¿å¿…é ˆ
- è¤‡é›‘ãªå ´åˆã®ã¿ Mermaid ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ è¿½åŠ 
- ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ AI ãŒæ—¢å­˜ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‚’å‚ç…§

---

### 0.3 Error Handling Policy (æ‹¡å¼µ)

> **v3.0 æ‹¡å¼µ**: 4ã¤ã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ç´°åˆ†åŒ–

#### 0.3.1 Error Classification

```markdown
| ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ— | ã‚³ãƒ¼ãƒ‰ç¯„å›² | ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ | ãƒ­ã‚®ãƒ³ã‚°å¿…é ˆ |
|------------|-----------|:-----------:|:---------:|
| Validation | `VALIDATION_*` | âŒ | âŒ |
| Network | `NETWORK_*` | âœ… | âœ… |
| Auth | `AUTH_*` | æ¡ä»¶ä»˜ã | âœ… |
| Business | `BIZ_*` | âŒ | â­• |
| System | `SYSTEM_*` | âœ… | âœ… |
````

#### 0.3.2 User-Facing Messages

```markdown
| ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰          | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (ja)          | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¼              |
| --------------------- | -------------------------------- | --------------------------- |
| `NETWORK_OFFLINE`     | "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¦ãã ã•ã„" | `error_network_offline`     |
| `VALIDATION_REQUIRED` | "{field}ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"      | `error_validation_required` |
| `AUTH_EXPIRED`        | "å†ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™"           | `error_auth_expired`        |
```

#### 0.3.3 Recovery Actions

```markdown
| ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ— |     è‡ªå‹•å¾©æ—§     | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | UI è¡¨ç¤º       |
| ------------ | :--------------: | ------------------ | ------------- |
| Network      |   3å›ãƒªãƒˆãƒ©ã‚¤    | ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³     | Toast + Retry |
| Auth         | ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°è©¦è¡Œ | å†ãƒ­ã‚°ã‚¤ãƒ³         | Dialog        |
| Validation   |        -         | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¿®æ­£     | Inline error  |
| Business     |        -         | æ¡ˆå†…ç¢ºèª           | Dialog        |
```

#### 0.3.4 Logging Requirements

```markdown
| ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ— | ãƒ­ã‚°ãƒ¬ãƒ™ãƒ« | å«ã‚€æƒ…å ±                      | ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚° |
| ------------ | ---------- | ----------------------------- | ------------ |
| Network      | WARN       | `url`, `status`, `duration`   | 100%         |
| Auth         | ERROR      | `user_id`, `action`, `reason` | 100%         |
| Business     | INFO       | `action`, `params`            | 10%          |
| System       | ERROR      | `stack_trace`, `context`      | 100%         |
```

**Fail-Fast åŸå‰‡**:

- ä¸æ­£ãªå…¥åŠ›ã¯å³åº§ã«æ¤œè¨¼ã—ã¦å¤±æ•—å‡¦ç†
- Silent failure ç¦æ­¢ (`catch (e) {}` ç¦æ­¢)
- å…¨ã¦ã®ã‚¨ãƒ©ãƒ¼ã¯ logger ã§è¨˜éŒ²

---

### 0.4 Data Schema & Security (å¿…é ˆ)

> **v3.0**: Zod ã‚¹ã‚­ãƒ¼ãƒã ã‘ã§ãªã **API ã‚¹ã‚­ãƒ¼ãƒ** ã‚‚å¿…é ˆè¨˜è¼‰
> **SSOT**: `src/features/{feature}/types/` ãŒçœŸå®Ÿã®åŸæ³‰ã€SPEC ã¯è¦ç´„ + æ„å›³è¨˜éŒ²

#### 0.4.1 Zod ã‚¹ã‚­ãƒ¼ãƒ (ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´)

```markdown
| ã‚¹ã‚­ãƒ¼ãƒ               | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰/å‹                         | nullable | å‚™è€ƒ               |
| ---------------------- | ------------------------------------- | :------: | ------------------ |
| `CodeSubmissionSchema` | `id: z.string()`                      |    âŒ    | UUID               |
|                        | `code: z.string()`                    |    âŒ    | æå‡ºã‚³ãƒ¼ãƒ‰         |
|                        | `language: z.string()`                |    âŒ    | ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª |
|                        | `errorMessage: z.string().optional()` |    â­•    | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸   |
|                        | `goal: z.string().optional()`         |    â­•    | å­¦ç¿’ç›®æ¨™           |
|                        | `createdAt: z.string().datetime()`    |    âŒ    |                    |
```

**Zod ã‚¹ã‚­ãƒ¼ãƒè¦å‰‡**:

- `z.object()` ã§ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
- `z.infer<typeof Schema>` ã§ TypeScript å‹ã‚’å°å‡º
- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯æ—¥æœ¬èªã§å®šç¾©

##### 0.4.1.1 Model Invariants (v3.3 æ–°è¦)

> **ç›®çš„**: ãƒ¢ãƒ‡ãƒ«ãƒ¬ãƒ™ãƒ«ã§çµ¶å¯¾ã«å£Šã‚Œã¦ã¯ã„ã‘ãªã„ãƒ«ãƒ¼ãƒ«å®šç¾©
> **æ¤œè¨¼æ™‚ç‚¹**: Zod parseã€ãƒ•ã‚¡ã‚¯ãƒˆãƒªé–¢æ•°ã€çŠ¶æ…‹æ›´æ–°æ™‚

````markdown
#### Model Invariants

| Model            |  INV-ID  | ä¸å¤‰æ¡ä»¶                      | æ¤œè¨¼æ–¹æ³•                   | é•åæ™‚     |
| ---------------- | :------: | ----------------------------- | -------------------------- | ---------- |
| `CodeSubmission` | M-INV-01 | `code` ã¯ç©ºæ–‡å­—ä¸å¯           | `z.string().min(1)`        | `ZodError` |
| `CodeSubmission` | M-INV-02 | `language` ã¯ã‚µãƒãƒ¼ãƒˆè¨€èªã®ã¿ | `z.enum([...])`            | `ZodError` |
| `QuizAnswer`     | M-INV-03 | `selectedIndex` >= 0          | `z.number().nonnegative()` | `ZodError` |

**ä¸å¤‰æ¡ä»¶å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**:

```typescript
import { z } from 'zod';

/** ã‚³ãƒ¼ãƒ‰æå‡ºã‚¹ã‚­ãƒ¼ãƒ - ä¸å¤‰æ¡ä»¶ã‚’ Zod ã§ä¿è¨¼ */
export const CodeSubmissionSchema = z.object({
  id: z.string().uuid(),
  // M-INV-01: code ã¯ç©ºæ–‡å­—ä¸å¯
  code: z.string().min(1, 'ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'),
  // M-INV-02: language ã¯ã‚µãƒãƒ¼ãƒˆè¨€èªã®ã¿
  language: z.enum(['typescript', 'javascript', 'python', 'java']),
  errorMessage: z.string().optional(),
  goal: z.string().optional(),
  createdAt: z.string().datetime(),
});

export type CodeSubmission = z.infer<typeof CodeSubmissionSchema>;
```
````

````

**Model Invariants ä½œæˆåŸå‰‡**:
- ã™ã¹ã¦ã®**ãƒ“ã‚¸ãƒã‚¹æ ¸å¿ƒåˆ¶ç´„**ã‚’ä¸å¤‰æ¡ä»¶ã¨ã—ã¦æ–‡æ›¸åŒ–
- æ¤œè¨¼å¤±æ•—æ™‚ã®å‹•ä½œ (ä¾‹å¤– vs è‡ªå‹•è£œæ­£) ã‚’æ˜ç¤º
- **Zod ã‚¹ã‚­ãƒ¼ãƒã§æ¤œè¨¼** (ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ä¿è¨¼)

---

### 0.5 API Contract (å¿…é ˆ) - Hybrid v3.1

> **v3.1 æ›´æ–°**: ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ–¹å¼ (Schema ãƒ†ãƒ¼ãƒ–ãƒ« + Example JSON) å°å…¥
> **SSOT åŸå‰‡**: ã‚³ãƒ¼ãƒ‰ã® `route.ts` > Schema ãƒ†ãƒ¼ãƒ–ãƒ« > Example JSON
> **æ¤œè¨¼**: `spec-validator` ãŒ Example â†” Schema ä¸€è‡´ã‚’è‡ªå‹•æ¤œè¨¼

#### API ä½¿ç”¨æœ‰ç„¡åˆ¤æ–­

| çŠ¶æ³ | å‡¦ç† |
|------|------|
| API Route **ãªã—** | `Â§0.5: N/A - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå‡¦ç†ã®ã¿` æ˜ç¤º |
| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ **1-2å€‹** | Â§0.5 ã«ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å½¢å¼ã§ä½œæˆ |
| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ **3å€‹+** ã¾ãŸã¯ **100è¡Œ+** | åˆ¥é€” `API-{NNN}.md` åˆ†é›¢ |

#### Â§0.5 ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å½¢å¼ (v3.1)

```markdown
### 0.5 API Contract

> **SSOT**: `src/app/api/analysis/route.ts`

#### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

| ID | Method | Path | Auth | Idempotent | Description |
|----|--------|------|:----:|:----------:|-------------|
| API-001-01 | POST | `/api/analysis/analyze` | âŒ | âŒ | ã‚³ãƒ¼ãƒ‰åˆ†æ |

#### API-001-01: analyze

##### Request Schema (SSOT)

| Field | Type | Required | Constraints | Description | Example |
|-------|------|:--------:|-------------|-------------|---------|
| `code` | string | âœ… | minLength: 1, maxLength: 10000 | åˆ†æå¯¾è±¡ã‚³ãƒ¼ãƒ‰ | `"function add..."` |
| `language` | string | âœ… | enum: typescript, javascript, python, java | è¨€èª | `"typescript"` |
| `errorMessage` | string | âšª | maxLength: 2000 | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | `"TypeError..."` |
| `goal` | string | âšª | maxLength: 500 | å­¦ç¿’ç›®æ¨™ | `"é…åˆ—æ“ä½œã‚’ç†è§£ã™ã‚‹"` |

##### Request Example

```json
{
  "code": "function add(a, b) { return a + b; }",
  "language": "typescript",
  "goal": "é–¢æ•°ã®åŸºæœ¬ã‚’ç†è§£ã™ã‚‹"
}
````

##### Response Schema (SSOT)

| Field              | Type   | Required | Constraints         | Description      | Example              |
| ------------------ | ------ | :------: | ------------------- | ---------------- | -------------------- |
| `status`           | string |    âœ…    | enum: `ok`, `error` | å‡¦ç†çµæœ         | `"ok"`               |
| `data`             | object |    âšª    | -                   | æˆåŠŸæ™‚çµæœ       | `{}`                 |
| `data.explanation` | string |    âšª    | -                   | æ•™è‚²çš„èª¬æ˜       | `"ã“ã®é–¢æ•°ã¯..."`    |
| `data.diff`        | object |    âšª    | -                   | ã‚³ãƒ¼ãƒ‰æ”¹å–„ææ¡ˆ   | `{}`                 |
| `error`            | object |    âšª    | status=error æ™‚     | ã‚¨ãƒ©ãƒ¼æƒ…å ±       | `{}`                 |
| `error.code`       | string |    âšª    | UPPER_SNAKE_CASE    | ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰     | `"INVALID_INPUT"`    |
| `error.message`    | string |    âšª    | -                   | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | `"ã‚³ãƒ¼ãƒ‰ã¯å¿…é ˆã§ã™"` |

##### Success Response Example (200 OK)

```json
{
  "status": "ok",
  "data": {
    "explanation": "ã“ã®é–¢æ•°ã¯2ã¤ã®å¼•æ•°ã‚’å—ã‘å–ã‚Š...",
    "diff": {
      "before": "function add(a, b) { return a + b; }",
      "after": "function add(a: number, b: number): number { return a + b; }"
    }
  }
}
```

##### Error Codes

| HTTP | Code             | Condition          | User Message (ja)            | Client Action            |
| :--: | ---------------- | ------------------ | ---------------------------- | ------------------------ |
| 400  | `INVALID_INPUT`  | å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ¼ã‚Œ | "å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„" | Inline ã‚¨ãƒ©ãƒ¼è¡¨ç¤º        |
| 429  | `RATE_LIMITED`   | ãƒªã‚¯ã‚¨ã‚¹ãƒˆéå¤š     | "ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„"     | æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•å¾Œãƒªãƒˆãƒ©ã‚¤ |
| 500  | `INTERNAL_ERROR` | ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼     | "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"       | ãƒªãƒˆãƒ©ã‚¤ (æœ€å¤§2å›)       |

````

#### ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å½¢å¼ä½œæˆåŸå‰‡

| è¦ç´  | å¿…é ˆ | å½¹å‰² | æ¤œè¨¼æ–¹æ³• |
|------|:----:|------|---------|
| **Schema ãƒ†ãƒ¼ãƒ–ãƒ«** | âœ… | å‹/åˆ¶ç´„æ¡ä»¶å®šç¾© (SSOT) | spec-validator |
| **Request Example** | âœ… | å®Ÿéš›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢æ…‹ | Schema ã¨ä¸€è‡´æ¤œè¨¼ |
| **Response Example** | âœ… | å®Ÿéš›ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢æ…‹ | Schema ã¨ä¸€è‡´æ¤œè¨¼ |
| **Error Codes ãƒ†ãƒ¼ãƒ–ãƒ«** | âœ… | ã‚¨ãƒ©ãƒ¼ä¸€è¦§ + å¯¾å¿œ | - |
| **Error Examples** | âœ… | ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢æ…‹ | Error Codes ã¨ä¸€è‡´æ¤œè¨¼ |

---

### 0.6 NFR (Non-Functional Requirements) - å¿…é ˆ

> **ç›®çš„**: AI ãŒå“è³ªåŸºæº–ã‚’æº€ãŸã™å®Ÿè£…ãŒã§ãã‚‹ã‚ˆã†æ˜ç¢ºãªç›®æ¨™æç¤º

```markdown
### 0.6 NFR (éæ©Ÿèƒ½è¦æ±‚äº‹é …)

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ (Performance)

| æŒ‡æ¨™ | ç›®æ¨™ | æ¸¬å®šæ–¹æ³• |
|------|------|---------|
| **åˆå›å¿œç­”æ™‚é–“** | < 500ms | API å‘¼ã³å‡ºã—é–‹å§‹ â†’ åˆãƒã‚¤ãƒˆå—ä¿¡ |
| **å…¨ä½“å¿œç­”æ™‚é–“** | < 2s (P95) | API å‘¼ã³å‡ºã—é–‹å§‹ â†’ å®Œäº† |
| **ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°é–‹å§‹** | < 1s | (ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚° API ã®ã¿) åˆãƒãƒ£ãƒ³ã‚¯å—ä¿¡ |

#### åŒæ™‚æ€§ (Concurrency)

| é …ç›® | äºˆæƒ³å€¤ | å‚™è€ƒ |
|------|--------|------|
| **åŒæ™‚ãƒ¦ãƒ¼ã‚¶ãƒ¼** | ~100å | MVP åŸºæº– |
| **ãƒ¦ãƒ¼ã‚¶ãƒ¼å½“ãŸã‚Šãƒªã‚¯ã‚¨ã‚¹ãƒˆé »åº¦** | 1å›/10ç§’ | å¹³å‡ |
| **ãƒ”ãƒ¼ã‚¯å€æ•°** | 3x | ãƒ”ãƒ¼ã‚¯æ™‚300åŒæ™‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆ |

#### ä¿¡é ¼æ€§ (Reliability)

| é …ç›® | ãƒãƒªã‚·ãƒ¼ | å‚™è€ƒ |
|------|---------|------|
| **ãƒªãƒˆãƒ©ã‚¤** | æœ€å¤§2å›ã€æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ• | Network/5xx ã®ã¿ |
| **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ** | 30ç§’ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ |

#### ã‚³ã‚¹ãƒˆ (Cost) - AI ä½¿ç”¨æ©Ÿèƒ½ã®ã¿

| é …ç›® | ä¸Šé™ | å‚™è€ƒ |
|------|------|------|
| **LLM å‘¼ã³å‡ºã—å›æ•°** | 10å›/ãƒ¦ãƒ¼ã‚¶ãƒ¼/æ—¥ | ç„¡æ–™ãƒ—ãƒ©ãƒ³ |
| **ãƒˆãƒ¼ã‚¯ãƒ³ä¸Šé™** | å…¥åŠ› 2Kã€å‡ºåŠ› 1K | ãƒªã‚¯ã‚¨ã‚¹ãƒˆå½“ãŸã‚Š |
| **æœˆé–“ã‚³ã‚¹ãƒˆä¸Šé™** | $100 | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆè¨ˆ |

#### å¯è¦³æ¸¬æ€§ (Observability)

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ­ã‚°é …ç›®** | `user_id`, `action`, `duration_ms`, `status` |
| **ãƒ¡ãƒˆãƒªã‚¯ã‚¹** | `analysis_total`, `analysis_duration_seconds` |
| **ã‚¢ãƒ©ãƒ¼ãƒˆæ¡ä»¶** | ã‚¨ãƒ©ãƒ¼ç‡ > 5% (5åˆ†é–“), P95 > 3s |
````

**NFR ä½œæˆåŸå‰‡**:

- ã™ã¹ã¦ã®æ•°å€¤ã¯**æ¸¬å®šå¯èƒ½**ã§ã‚ã‚‹ã“ã¨
- AI ä½¿ç”¨æ©Ÿèƒ½ã¯**ã‚³ã‚¹ãƒˆä¸Šé™**å¿…é ˆ
- è©²å½“ãªã—ã®é …ç›®ã¯ "N/A" æ˜ç¤º (ç©ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ç¦æ­¢)

---

### 0.7 AI Logic & Prompts (AI æ©Ÿèƒ½å¿…é ˆ)

> **ç›®çš„**: AI ãŒ AI æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹éš›ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¨å‹•ä½œã‚’æ­£ç¢ºã«å†ç¾ã§ãã‚‹ã‚ˆã†ã«

```markdown
### 0.7 AI Logic & Prompts

> âš ï¸ **AI æ©Ÿèƒ½å¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³** - LLM/GenAI ã‚’ä½¿ç”¨ã—ãªã„æ©Ÿèƒ½ã¯ "N/A" æ˜ç¤º

#### 0.7.1 AI å½¹å‰²å®šç¾©

| å½¹å‰²          | è²¬ä»»                     | ä½¿ç”¨ãƒ¢ãƒ‡ãƒ« | ãƒˆãƒ¼ã‚¯ãƒ³ä¸Šé™      |
| ------------- | ------------------------ | ---------- | ----------------- |
| **Analyzer**  | ã‚³ãƒ¼ãƒ‰åˆ†æã€å•é¡Œç‚¹æŠ½å‡º   | Gemini     | å…¥åŠ› 2K, å‡ºåŠ› 1K  |
| **Explainer** | æ•™è‚²çš„èª¬æ˜ç”Ÿæˆ           | Gemini     | å…¥åŠ› 2K, å‡ºåŠ› 2K  |
| **QuizMaker** | ç†è§£åº¦ãƒã‚§ãƒƒã‚¯ã‚¯ã‚¤ã‚ºç”Ÿæˆ | Gemini     | å…¥åŠ› 1K, å‡ºåŠ› 512 |

#### 0.7.2 System Prompt ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

> SSOT: `src/config/gemini-config.ts` ã¾ãŸã¯ API Route å†…

**Analyzer Prompt**:
```

You are a programming education assistant.
Analyze the submitted code and provide educational feedback.

## Context

- Language: {{language}}
- User Goal: {{goal}}
- Error (if any): {{errorMessage}}

## Analysis Rules

1. Identify key concepts demonstrated in the code
2. Find potential improvements with educational explanations
3. If there's an error, explain why it occurs and how to fix it

## Output Format (JSON only)

{ "concepts": [...], "improvements": [...], "errorAnalysis": {...} }

````

#### 0.7.3 Response Schema (Structured Output)

> **å¿…é ˆ**: Gemini responseSchema ã§å¼·åˆ¶ã€è‡ªç”±ãƒ†ã‚­ã‚¹ãƒˆå¿œç­”ç¦æ­¢

**Analyzer Response**:
```json
{
  "type": "object",
  "required": ["concepts", "improvements"],
  "properties": {
    "concepts": { "type": "array", "items": { "type": "string" } },
    "improvements": { "type": "array", "items": { "type": "object" } },
    "errorAnalysis": { "type": "object" }
  }
}
````

#### 0.7.4 Prompt å¤‰æ•°æ³¨å…¥

| å¤‰æ•°               | ã‚½ãƒ¼ã‚¹          | å‹     | å¿…é ˆ |
| ------------------ | --------------- | ------ | :--: |
| `{{language}}`     | ãƒªã‚¯ã‚¨ã‚¹ãƒˆ body | string |  âœ…  |
| `{{goal}}`         | ãƒªã‚¯ã‚¨ã‚¹ãƒˆ body | string |  âšª  |
| `{{errorMessage}}` | ãƒªã‚¯ã‚¨ã‚¹ãƒˆ body | string |  âšª  |

````

**AI Logic ä½œæˆåŸå‰‡**:
- System Prompt ã¯**å®Ÿéš›ã«ä½¿ç”¨ã™ã‚‹å…¨ãƒ†ã‚­ã‚¹ãƒˆ**è¨˜è¼‰ (è¦ç´„ç¦æ­¢)
- å¤‰æ•°ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã¯ `{{variable}}` å½¢å¼çµ±ä¸€
- Response Schema ã¯**å®Ÿéš›ã®ã‚¹ã‚­ãƒ¼ãƒã¨åŒä¸€**ã§ã‚ã‚‹ã“ã¨
- ãƒˆãƒ¼ã‚¯ãƒ³ä¸Šé™ã¯ã‚³ã‚¹ãƒˆè¨ˆç®—ã®æ ¹æ‹ 

---

### 0.8 Safety & Guardrails (AI æ©Ÿèƒ½å¿…é ˆ)

> **ç›®çš„**: AI å¿œç­”ã®å®‰å…¨æ€§ã€ä¸€è²«æ€§ã€å“è³ªä¿è¨¼

```markdown
### 0.8 Safety & Guardrails

> âš ï¸ **AI æ©Ÿèƒ½å¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³** - LLM/GenAI ã‚’ä½¿ç”¨ã—ãªã„æ©Ÿèƒ½ã¯ "N/A" æ˜ç¤º

#### 0.8.1 å…¥åŠ›æ¤œè¨¼ (Input Validation)

| æ¤œè¨¼é …ç›® | ãƒ«ãƒ¼ãƒ« | å¤±æ•—æ™‚å‡¦ç† |
|---------|--------|----------|
| å…¥åŠ›é•· | max 10000æ–‡å­— (code) | 400 Bad Request + ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé€šçŸ¥ |
| ç¦æ­¢èªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ | æ‚ªæ„ã‚ã‚‹ã‚³ãƒ¼ãƒ‰æ¤œå‡º | å…¥åŠ›æ‹’å¦ + è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³é˜²æ­¢ | ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³é™¤å» | è‡ªå‹•ã‚¨ã‚¹ã‚±ãƒ¼ãƒ— |

#### 0.8.2 å‡ºåŠ›æ¤œè¨¼ (Output Validation)

| æ¤œè¨¼é …ç›® | ãƒ«ãƒ¼ãƒ« | å¤±æ•—æ™‚å‡¦ç† |
|---------|--------|----------|
| JSON ãƒ‘ãƒ¼ã‚¹ | responseSchema æº–æ‹  | ãƒªãƒˆãƒ©ã‚¤1å› â†’ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¿œç­” |
| å¿œç­”é•· | max 5000æ–‡å­— | è‡ªå‹• truncate |

#### 0.8.3 Rate Limiting

| åˆ¶é™é …ç›® | ç„¡æ–™ãƒ—ãƒ©ãƒ³ | è¶…éæ™‚ |
|---------|-----------|--------|
| AI å‘¼ã³å‡ºã—/åˆ† | 5å› | 429 + å¾…æ©Ÿæ™‚é–“è¡¨ç¤º |
| AI å‘¼ã³å‡ºã—/æ—¥ | 50å› | æ—¥æ¬¡ä¸Šé™é€šçŸ¥ |

#### 0.8.4 Fallback æˆ¦ç•¥

| å¤±æ•—ã‚¿ã‚¤ãƒ— | Fallback | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
|----------|----------|----------------|
| LLM ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ (>30s) | äº‹å‰å®šç¾©å¿œç­”ä½¿ç”¨ | "ã—ã°ã‚‰ãã—ã¦ã‹ã‚‰ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„" |
| JSON ãƒ‘ãƒ¼ã‚¹å¤±æ•— | ãƒªãƒˆãƒ©ã‚¤1å›å¾Œãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¿œç­” | (é€éçš„ã«å‡¦ç†) |
| Rate Limit è¶…é | æ‹’å¦ | "ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå¤šã™ãã¾ã™ã€‚{{seconds}}ç§’å¾Œã«ãŠè©¦ã—ãã ã•ã„" |
````

**Safety ä½œæˆåŸå‰‡**:

- **ã™ã¹ã¦ã® AI æ©Ÿèƒ½ã«å¿…é ˆ** (è©²å½“ãªã—ãªã‚‰ "N/A" æ˜ç¤º)
- Fallback ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’è€ƒæ…®ã—ãŸ**å…·ä½“çš„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**å«ã‚€
- Rate Limit ã¯æ˜ç¤º

---

### 0.9 Design Tokens (v3.0 æ–°è¦)

> **ç›®çš„**: AI ãŒãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãªã—ã«ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«
> **SSOT**: `src/app/globals.css` ãŠã‚ˆã³ CLAUDE.md ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³

```markdown
### 0.9 Design Tokens

> **å‚ç…§**: CLAUDE.md ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ (Terminal Noir)

#### 0.9.1 Color Tokens

| ç”¨é€”           | ãƒˆãƒ¼ã‚¯ãƒ³                      | ä½¿ç”¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ           |
| -------------- | ----------------------------- | -------------------------- |
| Primary Action | `text-primary` / `bg-primary` | CTA ãƒœã‚¿ãƒ³ã€å¼·èª¿ãƒ†ã‚­ã‚¹ãƒˆ   |
| Error State    | `text-destructive`            | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€æ¤œè¨¼å¤±æ•— |
| Surface        | `bg-card`                     | ã‚«ãƒ¼ãƒ‰èƒŒæ™¯                 |
| On Surface     | `text-card-foreground`        | ã‚«ãƒ¼ãƒ‰ä¸Šãƒ†ã‚­ã‚¹ãƒˆ           |
| Muted          | `text-muted-foreground`       | è£œåŠ©ãƒ†ã‚­ã‚¹ãƒˆ               |

**ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³**:

- âŒ `text-red-500` â†’ âœ… `text-destructive`
- âŒ `bg-[#1e3a8a]` â†’ âœ… `bg-card`
- âŒ `text-white` â†’ âœ… `text-foreground`

#### 0.9.2 Typography Tokens

| ç”¨é€”           | Tailwind ã‚¯ãƒ©ã‚¹                    | ä½¿ç”¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ   |
| -------------- | ---------------------------------- | ------------------ |
| Page Title     | `text-2xl font-semibold font-sans` | ãƒ˜ãƒƒãƒ€ãƒ¼è¦‹å‡ºã—     |
| Section Header | `text-lg font-semibold font-sans`  | ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ |
| Body Text      | `text-sm font-normal font-sans`    | ä¸€èˆ¬ãƒ†ã‚­ã‚¹ãƒˆ       |
| Code Text      | `text-sm font-mono`                | ã‚³ãƒ¼ãƒ‰è¡¨ç¤º         |

#### 0.9.3 Spacing Tokens

| ç”¨é€”          | å€¤             | ä½¿ç”¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ |
| ------------- | -------------- | ---------------- |
| Card Padding  | `p-4` (16px)   | ã‚«ãƒ¼ãƒ‰å†…éƒ¨ä½™ç™½   |
| List Item Gap | `gap-2` (8px)  | ä¸€è¦§é …ç›®é–“éš”     |
| Section Gap   | `gap-6` (24px) | ã‚»ã‚¯ã‚·ãƒ§ãƒ³é–“é–“éš” |

#### 0.9.4 Common Components

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ   | ãƒ‘ã‚¹                                                                             | ç”¨é€”                 |
| ---------------- | -------------------------------------------------------------------------------- | -------------------- |
| `LoadingSpinner` | `src/shared/components/common/`                                                  | ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹è¡¨ç¤º |
| `AppHeader`      | `src/shared/components/layout/`                                                  | ãƒ˜ãƒƒãƒ€ãƒ¼             |
| Glass Panel      | Tailwind ã‚¯ãƒ©ã‚¹: `backdrop-blur-xl bg-white/5 border border-white/10 rounded-xl` | ãƒ‘ãƒãƒ«æ¨™æº–           |
```

**Design Token ä½œæˆåŸå‰‡**:

- **ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è‰²/ãƒ•ã‚©ãƒ³ãƒˆç¦æ­¢** - å¿…ãš CSS å¤‰æ•° / Tailwind ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨
- æ—¢å­˜å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†åˆ©ç”¨å„ªå…ˆ
- æ–°è¦ãƒˆãƒ¼ã‚¯ãƒ³å¿…è¦æ™‚ã¯ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã«å…ˆã«ç™»éŒ²

#### 0.9.5 UI Interaction Rules å‚ç…§ (v3.1 æ–°è¦)

```markdown
#### 0.9.5 UI Interaction Rules

> **å…±é€šãƒ«ãƒ¼ãƒ«å‚ç…§**: CLAUDE.md ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ  - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³
>
> - ãƒ›ãƒãƒ¼/ã‚¯ãƒªãƒƒã‚¯åå¿œ: 150ms (micro)
> - ãƒˆã‚°ãƒ«/ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³: 250ms (small)
> - ãƒ¢ãƒ¼ãƒ€ãƒ«/ãƒ‘ãƒãƒ«é·ç§»: 400ms (medium)
> - easing: `cubic-bezier(0.16, 1, 0.3, 1)`

**ã“ã®æ©Ÿèƒ½ã®ä¾‹å¤–/ç‰¹æ®Šãƒ«ãƒ¼ãƒ«**:

| é …ç›®           | å…±é€šãƒ«ãƒ¼ãƒ«   | ã“ã®æ©Ÿèƒ½ã®ä¾‹å¤–              | ç†ç”±           |
| -------------- | ------------ | --------------------------- | -------------- |
| ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°   | ã‚¹ãƒ”ãƒŠãƒ¼è¡¨ç¤º | AI å¿œç­”ã¯ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è¡¨ç¤º | é•·ã„å¾…æ©Ÿæ™‚é–“   |
| ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ | Toast 3ç§’    | åˆ†æå®Œäº†ã¯ Panel é·ç§»       | è¤‡é›‘ãªçµæœè¡¨ç¤º |

**ä¾‹å¤–ãªã—æ™‚**: "å…±é€šãƒ«ãƒ¼ãƒ«å…¨ä½“æº–æ‹ " æ˜ç¤º
```

---

## ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 1: æ¦‚è¦ (å¿…é ˆ)

### 1.1 ç›®æ¨™ (WHY)

```markdown
### ç›®æ¨™ (WHY)

{1-2æ–‡ã§ãƒ“ã‚¸ãƒã‚¹æ ¹æ‹ ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¾¡å€¤}

ä¾‹: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæå‡ºã—ãŸã‚³ãƒ¼ãƒ‰ã‚’AIãŒåˆ†æã—ã€æ•™è‚²çš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æä¾›ã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å­¦ç¿’ã®ç†è§£åº¦ã‚’30%å‘ä¸Šã•ã›ã‚‹ã€‚"
```

**ä½œæˆåŸå‰‡**:

- CONTEXT.json ã® Why & Success Criteria ã‚’è¦ç´„
- æ¸¬å®šå¯èƒ½ãªç›®æ¨™ã‚’å«ã‚€ (å¯èƒ½ãªå ´åˆ)

### 1.2 ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

```markdown
### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

AS A ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å­¦ç¿’è€…
I WANT TO æå‡ºã—ãŸã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦æ•™è‚²çš„ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å—ã‘ãŸã„
SO THAT ã‚¨ãƒ©ãƒ¼ã®åŸå› ã¨æ”¹å–„æ–¹æ³•ã‚’ç†è§£ã§ãã‚‹
```

### 1.3 MVP ç¯„å›²

```markdown
### MVP ç¯„å›²

| å«ã‚€             | é™¤å¤–                         |
| ---------------- | ---------------------------- |
| ã‚³ãƒ¼ãƒ‰åˆ†æãƒ»èª¬æ˜ | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ |
| Diff ææ¡ˆ        | ã‚³ãƒ¼ãƒ‰è‡ªå‹•ä¿®æ­£               |
| ç†è§£åº¦ã‚¯ã‚¤ã‚º     | å­¦ç¿’ãƒ‘ã‚¹æ¨å¥¨                 |
```

### 1.4 Goals / Non-Goals (å¿…é ˆ)

```markdown
### Goals (ã“ã® SPEC ãŒé”æˆã™ã‚‹ã“ã¨)

- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚³ãƒ¼ãƒ‰ã‚’æå‡ºã—ã¦ AI åˆ†æã‚’å—ã‘ã‚‰ã‚Œã‚‹
- [ ] æ•™è‚²çš„èª¬æ˜ãŒã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã§è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã‚³ãƒ¼ãƒ‰æ”¹å–„ã® Before/After Diff ãŒè¡¨ç¤ºã•ã‚Œã‚‹

### Non-Goals (ã“ã® SPEC ã§æ‰±ã‚ãªã„ã“ã¨)

> âš ï¸ **é‡è¦**: Non-Goals ã¯ "å¾Œã§ã‚„ã‚‹ã“ã¨" ã§ã¯ãªã "æ„å›³çš„ã«é™¤å¤–ã—ãŸã“ã¨"

| é™¤å¤–é …ç›®           | é™¤å¤–ç†ç”±                 | ä»£æ›¿ (ã‚ã‚Œã°)   |
| ------------------ | ------------------------ | --------------- |
| ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚³ãƒ©ãƒœ | MVP ç¯„å›²è¶…éã€è¤‡é›‘åº¦å¢—åŠ  | Phase 2 ã§æ¤œè¨  |
| ã‚³ãƒ¼ãƒ‰è‡ªå‹•ä¿®æ­£     | æ•™è‚²ç›®çš„ã¨çŸ›ç›¾           | Diff ææ¡ˆã§ä»£æ›¿ |
```

### 1.5 Screen Flow (v3.0 æ–°è¦)

```markdown
### 1.5 Screen Flow

#### ç”»é¢ãƒ•ãƒ­ãƒ¼å›³ (Tier 1-2):
```

[ãƒ›ãƒ¼ãƒ ç”»é¢]
â”‚
â”œâ”€â”€[ã‚³ãƒ¼ãƒ‰å…¥åŠ›]â”€â”€â–¶ [åˆ†æä¸­]
â”‚ â”‚
â”‚ â”œâ”€â”€[å®Œäº†]â”€â”€â–¶ [èª¬æ˜è¡¨ç¤º]
â”‚ â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€[Diff ã‚¿ãƒ–]â”€â”€â–¶ [Diff è¡¨ç¤º]
â”‚ â”‚ â””â”€â”€[ã‚¯ã‚¤ã‚ºã‚¿ãƒ–]â”€â”€â–¶ [ã‚¯ã‚¤ã‚º]
â”‚ â”‚
â”‚ â””â”€â”€[ã‚¨ãƒ©ãƒ¼]â”€â”€â–¶ [ã‚¨ãƒ©ãƒ¼è¡¨ç¤º + ãƒªãƒˆãƒ©ã‚¤]

```

#### ç”»é¢é·ç§»ãƒ†ãƒ¼ãƒ–ãƒ«:

| From | Action | To | ãƒ‡ãƒ¼ã‚¿ä¼é” |
|------|--------|-----|-----------|
| Home | ã‚³ãƒ¼ãƒ‰å…¥åŠ›å®Œäº† | Analysis | `codeSubmission` |
| Analysis | åˆ†æå®Œäº† | Explanation | `analysisResult` |
| Explanation | Diff ã‚¿ãƒ– | DiffView | `diff` |
| Explanation | ã‚¯ã‚¤ã‚ºã‚¿ãƒ– | Quiz | `quizData` |
```

---

## ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 2: æ©Ÿèƒ½è¦æ±‚äº‹é … (å¿…é ˆ)

> **åŸå‰‡**: å„ FR ã¯ç‹¬ç«‹çš„ã«å®Ÿè£…ãŠã‚ˆã³ãƒ†ã‚¹ãƒˆå¯èƒ½ã§ã‚ã‚‹ã“ã¨

### FR ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

````markdown
### FR-{NNN}01: {æ©Ÿèƒ½å}

| é …ç›®             | å†…å®¹                                           |
| ---------------- | ---------------------------------------------- |
| **èª¬æ˜**         | {æ©Ÿèƒ½ã®å‹•ä½œã‚’1-2æ–‡ã§æ˜ç¢ºã«}                    |
| **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«** | `src/features/{feature}/components/{name}.tsx` |
| **ãƒ†ã‚¹ãƒˆ**       | `tests/unit/{name}.test.ts`                    |
| **çŠ¶æ…‹å¤‰åŒ–**     | {ä¾‹: idle â†’ loading â†’ data/error}              |
| **çŠ¶æ…‹**         | â¬œ æœªç€æ‰‹                                      |

**å—å®¹åŸºæº– (AC)**:

| AC  | Given (äº‹å‰æ¡ä»¶) | When (è¡Œå‹•) | Then (æœŸå¾…çµæœ) | è¦³æ¸¬ç‚¹          |
| :-: | ---------------- | ----------- | --------------- | --------------- |
| AC1 | {äº‹å‰æ¡ä»¶}       | {è¡Œå‹•}      | {æœŸå¾…çµæœ}      | {æ¤œè¨¼å¤‰æ•°/çŠ¶æ…‹} |
| AC2 | {äº‹å‰æ¡ä»¶}       | {è¡Œå‹•}      | {æœŸå¾…çµæœ}      | {æ¤œè¨¼å¤‰æ•°/çŠ¶æ…‹} |

**Edge Cases (EC)**:

- EC1: {ä¾‹å¤–çŠ¶æ³} â†’ {å‡¦ç†æ–¹æ³•}
- EC2: ...

**Exception Flows (EF)**:

> æ­£å¸¸ãƒ•ãƒ­ãƒ¼ä»¥å¤–ã®**ã™ã¹ã¦ã®ä¾‹å¤–ãƒ‘ã‚¹**ã‚’æ˜ç¤º

| EF  | ãƒˆãƒªã‚¬ãƒ¼æ¡ä»¶            | ã‚·ã‚¹ãƒ†ãƒ åå¿œ | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸                       | å¾©æ—§ãƒ‘ã‚¹           |
| :-: | ----------------------- | ------------ | ---------------------------------------- | ------------------ |
| EF1 | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³  | ã‚¨ãƒ©ãƒ¼è¡¨ç¤º   | "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¦ãã ã•ã„"         | ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³è¡¨ç¤º |
| EF2 | API ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ (>30s) | ãƒªãƒˆãƒ©ã‚¤1å›  | "ã—ã°ã‚‰ãã—ã¦ã‹ã‚‰ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„" | ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³è¡¨ç¤º |

**AI å®Ÿè£…ãƒ’ãƒ³ãƒˆ**:

```typescript
// å‚è€ƒãƒ‘ã‚¿ãƒ¼ãƒ³: src/features/explanation/hooks/use-explanation.ts
// ä½¿ç”¨ã™ã‚‹ Hook: useCodeInput
// çŠ¶æ…‹ç®¡ç†: useState + useEffect
```
````

````

**FR ä½œæˆåŸå‰‡**:
- FR ID ã¯æ©Ÿèƒ½ç•ªå· + é †ç•ª (FR-00101, FR-00102)
- **AC ã¯å¿…ãš BDD 5-column ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ä½¿ç”¨** (ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ AC ç¦æ­¢)
- AI ãƒ’ãƒ³ãƒˆã«ã¯å‚è€ƒã«ã™ã‚‹æ—¢å­˜ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹ã‚’å«ã‚€

### BDD AC ä½œæˆãƒ«ãƒ¼ãƒ«

**5-column æ§‹é€ **:

| ã‚«ãƒ©ãƒ  | å½¹å‰² | ä½œæˆåŸºæº– |
|--------|------|---------|
| AC | è­˜åˆ¥å­ | `AC1`, `AC2`, ... é †ç•ª |
| Given (äº‹å‰æ¡ä»¶) | ãƒ†ã‚¹ãƒˆã® setUp/Mock å¯¾è±¡ | "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ X çŠ¶æ…‹ã®æ™‚", "Y ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹æ™‚" |
| When (è¡Œå‹•) | ãƒ†ã‚¹ãƒˆã® Act å‹•ä½œ | "Z ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨", "API ã‚’å‘¼ã³å‡ºã™ã¨" |
| Then (æœŸå¾…çµæœ) | ãƒ†ã‚¹ãƒˆã® Assert å¯¾è±¡ | "W ãŒè¡¨ç¤ºã•ã‚Œã‚‹", "çŠ¶æ…‹ãŒ X ã«é·ç§»" |
| è¦³æ¸¬ç‚¹ | `expect()` ãƒãƒƒãƒãƒ£ãƒ¼å¯¾è±¡ | å…·ä½“çš„ãªå¤‰æ•°åã€çŠ¶æ…‹å€¤ã€UI è¦ç´  |

**Good ä¾‹ç¤º**:

| AC | Given (äº‹å‰æ¡ä»¶) | When (è¡Œå‹•) | Then (æœŸå¾…çµæœ) | è¦³æ¸¬ç‚¹ |
|:--:|-----------------|------------|---------------|--------|
| AC1 | ã‚³ãƒ¼ãƒ‰ãŒå…¥åŠ›ã•ã‚ŒãŸçŠ¶æ…‹ | åˆ†æãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ | AI åˆ†æçµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹ | `status === 'data'`, èª¬æ˜ãƒ‘ãƒãƒ«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° |
| AC2 | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ | åˆ†æã‚’å®Ÿè¡Œã™ã‚‹ã¨ | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | `status === 'error'`, Toast è¡¨ç¤º |

**ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ (ç¦æ­¢)**:

```markdown
âŒ Given ã®ãªã„ AC:
| AC1 | - | ã‚³ãƒ¼ãƒ‰åˆ†æã™ã‚‹ã¨ | çµæœè¡¨ç¤º | - |

âŒ Then ãŒä¸æ˜ç¢ºãª AC:
| AC1 | ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ | ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ | è¡¨ç¤ºã•ã‚Œã‚‹ | - |

âŒ è¦³æ¸¬ç‚¹æ¼ã‚Œ:
| AC1 | ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ | åˆ†æãƒœã‚¿ãƒ³ | çµæœè¡¨ç¤º | - |

âœ… æ­£ã—ã„ AC:
| AC1 | ã‚³ãƒ¼ãƒ‰3è¡Œå…¥åŠ›æ¸ˆã¿ã€TypeScripté¸æŠ | åˆ†æãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ | èª¬æ˜ãƒ»Diffãƒ»ã‚¯ã‚¤ã‚ºãŒè¡¨ç¤º | `status === 'data'`, 3ãƒ‘ãƒãƒ«è¡¨ç¤ºç¢ºèª |
````

---

### 2.X Business Rules / Logic (v3.0 æ–°è¦)

> **ç›®çš„**: AI ãŒè¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ pseudocode ã§æ­£ç¢ºã«ç†è§£ã™ã‚‹ã‚ˆã†ã«
> **ä½ç½®**: å„ FR å†…éƒ¨ã¾ãŸã¯åˆ¥ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–

#### Pseudocode Style Guide

> **åŸå‰‡**: è¨€èªã«ä¾å­˜ã—ãªã„æ˜ç¢ºãªç–‘ä¼¼ã‚³ãƒ¼ãƒ‰ã§ä½œæˆ

**ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¦å‰‡**:

| ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰                     | ç”¨é€”           | ä¾‹ç¤º                                  |
| ------------------------------ | -------------- | ------------------------------------- |
| `FUNCTION ... END FUNCTION`    | é–¢æ•°å®šç¾©       | `FUNCTION calc(x): ... END FUNCTION`  |
| `SET`                          | å¤‰æ•°ä»£å…¥       | `SET rate = 0.01`                     |
| `IF / ELSE IF / ELSE / END IF` | æ¡ä»¶åˆ†å²       | `IF x > 0: ... ELSE: ... END IF`      |
| `FOR ... END FOR`              | åå¾©æ–‡         | `FOR item IN items: ... END FOR`      |
| `WHILE ... END WHILE`          | æ¡ä»¶åå¾©       | `WHILE count < 10: ... END WHILE`     |
| `THROW Error(code, message)`   | ä¾‹å¤–ç™ºç”Ÿ       | `THROW Error("INVALID_INPUT", "...")` |
| `RETURN`                       | å€¤è¿”å´         | `RETURN result`                       |
| `// ã‚³ãƒ¡ãƒ³ãƒˆ`                  | ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³èª¬æ˜ | `SET rate = 0.01 // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ1%`     |

**çµ„ã¿è¾¼ã¿é–¢æ•°**:

| é–¢æ•°                      | èª¬æ˜      | ä¾‹ç¤º             |
| ------------------------- | --------- | ---------------- |
| `FLOOR(x)`                | åˆ‡ã‚Šæ¨ã¦  | `FLOOR(3.7)` â†’ 3 |
| `CEIL(x)`                 | åˆ‡ã‚Šä¸Šã’  | `CEIL(3.2)` â†’ 4  |
| `ROUND(x)`                | å››æ¨äº”å…¥  | `ROUND(3.5)` â†’ 4 |
| `MIN(a, b)` / `MAX(a, b)` | æœ€å°/æœ€å¤§ | `MAX(0, value)`  |
| `LEN(list)`               | é•·ã•      | `LEN(items)`     |
| `TRIM(str)`               | ç©ºç™½é™¤å»  | `TRIM(input)`    |

**ä½œæˆä¾‹ç¤º - ã‚³ãƒ¼ãƒ‰åˆ†æãƒ­ã‚¸ãƒƒã‚¯**:

```markdown
#### BR-001: ã‚³ãƒ¼ãƒ‰åˆ†æãƒ•ãƒ­ãƒ¼

**ãƒ«ãƒ¼ãƒ«**: æå‡ºã‚³ãƒ¼ãƒ‰ã®è¨€èªã¨å†…å®¹ã«åŸºã¥ã„ã¦åˆ†æã‚’å®Ÿè¡Œ

**Pseudocode**:
```

FUNCTION analyzeCode(code, language, errorMessage, goal):
// å…¥åŠ›æ¤œè¨¼
IF code IS EMPTY:
THROW Error("INVALID_INPUT", "ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")
END IF

    IF LEN(code) > 10000:
        THROW Error("INPUT_TOO_LONG", "ã‚³ãƒ¼ãƒ‰ã¯10000æ–‡å­—ä»¥å†…ã«ã—ã¦ãã ã•ã„")
    END IF

    // AI åˆ†æå®Ÿè¡Œ
    SET prompt = buildPrompt(code, language, errorMessage, goal)
    SET result = callGeminiAPI(prompt)

    // çµæœæ¤œè¨¼
    IF result IS NULL:
        THROW Error("ANALYSIS_FAILED", "åˆ†æã«å¤±æ•—ã—ã¾ã—ãŸ")
    END IF

    RETURN {
        explanation: result.explanation,
        diff: result.improvements,
        quiz: generateQuiz(result.concepts)
    }

END FUNCTION

```

**Truth Table**:
| code | language | çµæœ |
|------|----------|------|
| æœ‰åŠ¹ãªã‚³ãƒ¼ãƒ‰ | "typescript" | åˆ†æçµæœè¿”å´ |
| ç©ºæ–‡å­— | ANY | Error: INVALID_INPUT |
| 10001æ–‡å­— | ANY | Error: INPUT_TOO_LONG |
```

**Business Rules ä½œæˆåŸå‰‡**:

- **è¤‡é›‘ãªæ¡ä»¶/è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯**ã¯ pseudocode ã§æ˜ç¤º
- è¨€èªã«ä¾å­˜ã—ãªã„ pseudocode ä½¿ç”¨ (ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¦å‰‡æº–æ‹ )
- **Truth Table** ã§å¢ƒç•Œæ¡ä»¶ã‚’æ˜ç¢ºåŒ–
- **Edge Cases** ã¯ BR å†…ã«å«ã‚€

---

## ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 3: ä¾å­˜æ€§ & ãƒªã‚¹ã‚¯ (å¿…é ˆ)

### 3.1 å…ˆè¡Œä¾å­˜æ€§

```markdown
### å…ˆè¡Œä¾å­˜æ€§

| ä¾å­˜å¯¾è±¡   | å¿…è¦é …ç›®       | çŠ¶æ…‹ | å‚™è€ƒ             |
| ---------- | -------------- | :--: | ---------------- |
| Gemini API | API ã‚­ãƒ¼è¨­å®š   |  âœ…  | gemini-config.ts |
| SPEC-001   | ã‚³ãƒ¼ãƒ‰åˆ†ææ©Ÿèƒ½ |  â³  | API Route å¿…è¦   |
```

### 3.2 Top 3 ãƒªã‚¹ã‚¯

```markdown
### Top 3 ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯            | å½±éŸ¿ | å¯¾å¿œ                               |
| ----------------- | :--: | ---------------------------------- |
| AI å¿œç­”ã®ä¸å®‰å®šæ€§ | ä¸­é–“ | Structured Output + ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
| ãƒ¬ã‚¹ãƒãƒ³ã‚¹é…å»¶    | ä¸­é–“ | ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚° + ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ      |
| API ã‚³ã‚¹ãƒˆè¶…é    | ä½ã„ | Rate Limiting + æ—¥æ¬¡ä¸Šé™           |
```

### 3.4 Sequence Diagrams (Tier 1-2 å¿…é ˆ)

> **å¿…é ˆæ¡ä»¶**: Tier 1-2 æ©Ÿèƒ½ã€ã¾ãŸã¯ 3ã¤ä»¥ä¸Šã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç›¸äº’ä½œç”¨ã™ã‚‹å ´åˆ

```markdown
### Sequence Diagrams

#### SD-001: ã‚³ãƒ¼ãƒ‰åˆ†æãƒ•ãƒ­ãƒ¼ (Happy Path)
```

User UI/Component Hook API Route Gemini
â”‚ â”‚ â”‚ â”‚ â”‚
â”‚â”€â”€[1] ã‚³ãƒ¼ãƒ‰å…¥åŠ›â”€â”€â–¶â”‚ â”‚ â”‚ â”‚
â”‚ â”‚â”€â”€[2] submit()â”€â”€â–¶â”‚ â”‚ â”‚
â”‚ â”‚ â”‚â”€â”€[3] POST /apiâ”€â”€â–¶â”‚ â”‚
â”‚ â”‚ â”‚ â”‚â”€â”€[4] analyzeâ”€â”€â–¶â”‚
â”‚ â”‚ â”‚ â”‚â—€â”€[5] resultâ”€â”€â”€â”‚
â”‚ â”‚ â”‚â—€â”€[6] responseâ”€â”€â”€â”‚ â”‚
â”‚ â”‚â—€â”€[7] state updateâ”‚ â”‚ â”‚
â”‚â—€â”€[8] UI æ›´æ–°â”€â”€â”‚ â”‚ â”‚ â”‚

```

**è²¬ä»»åˆ†æ‹…**:
| ã‚¹ãƒ†ãƒƒãƒ— | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | è²¬ä»» |
|:------:|------------|------|
| 1-2 | UI/Component | ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›åé›†ã€Hook å‘¼ã³å‡ºã— |
| 3 | Hook | API å‘¼ã³å‡ºã— |
| 4-5 | API Route | AI é€£æº |
| 6-8 | Hookâ†’UI | çŠ¶æ…‹æ›´æ–°ã€UI åæ˜  |
```

---

## ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 4: ç”»é¢æ–‡æ›¸ (æ¡ä»¶ä»˜ã)

> UI å¤‰æ›´ãŒã‚ã‚‹å ´åˆã®ã¿ä½œæˆ

```markdown
### ç”»é¢æ–‡æ›¸

| ç”»é¢ ID     | ç”»é¢å         | æ–‡æ›¸                                                       | çŠ¶æ…‹ |
| ----------- | -------------- | ---------------------------------------------------------- | :--: |
| SCR-001-001 | ã‚³ãƒ¼ãƒ‰å…¥åŠ›ç”»é¢ | [screens/code-input.md](./screens/code-input.md)           |  â¬œ  |
| SCR-001-002 | åˆ†æçµæœç”»é¢   | [screens/analysis-result.md](./screens/analysis-result.md) |  â¬œ  |
```

---

## ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 5: æ¤œè¨¼ & ãƒ†ã‚¹ãƒˆ (v3.0 æ–°è¦)

> **ç›®çš„**: AI ãŒãƒ†ã‚¹ãƒˆä½œæˆæ™‚ã«ä¸€è²«ã—ãŸ fixture ã¨åŸºæº–ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«

### 5.1 Test Scenarios

````markdown
### 5.1 Test Scenarios

> **ç›®çš„**: ãƒ†ã‚¹ãƒˆã™ã‚‹ã‚·ãƒŠãƒªã‚ªã‚’ä¸€è¦§ã§å®šç¾©

#### å¿…é ˆãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª

| ã‚·ãƒŠãƒªã‚ª   | äº‹å‰æ¡ä»¶          | æœŸå¾…çµæœ                          |
| ---------- | ----------------- | --------------------------------- |
| æ­£å¸¸ãƒ­ãƒ¼ãƒ‰ | API æˆåŠŸ          | ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º                        |
| ç©ºãƒ‡ãƒ¼ã‚¿   | API æˆåŠŸ (ç©ºé…åˆ—) | ç©ºçŠ¶æ…‹è¡¨ç¤º                        |
| ã‚¨ãƒ©ãƒ¼     | API å¤±æ•—          | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ + ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³ |
| ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãªã—  | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸              |

#### Mock ãƒ‡ãƒ¼ã‚¿ä¾‹ç¤º (ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³)

```typescript
// ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ç›´æ¥å®šç¾©
const mockSubmission: CodeSubmission = {
  id: 'sub-001',
  code: 'function add(a, b) { return a + b; }',
  language: 'typescript',
  goal: 'é–¢æ•°ã®åŸºæœ¬ã‚’ç†è§£ã™ã‚‹',
  createdAt: '2026-02-11T10:30:00Z',
};
```
````

````

### 5.2 Acceptance Checklist

```markdown
### 5.2 Acceptance Checklist

> **ç”¨é€”**: PR ãƒãƒ¼ã‚¸å‰ã®æ‰‹å‹•æ¤œè¨¼é …ç›®

#### æ©Ÿèƒ½æ¤œè¨¼
- [ ] ã‚³ãƒ¼ãƒ‰å…¥åŠ›å¾Œåˆ†æçµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã§èª¬æ˜ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] Diff ãƒ“ãƒ¥ãƒ¼ã§ Before/After ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼
- [ ] åˆ†æé–‹å§‹ã‹ã‚‰åˆå›è¡¨ç¤º < 2s
- [ ] ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ä¸­ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ‰ãƒ­ãƒƒãƒ—ãªã—

#### ã‚¨ãƒ©ãƒ¼ã‚·ãƒŠãƒªã‚ª
- [ ] ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ â†’ é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
- [ ] ç©ºã‚³ãƒ¼ãƒ‰æå‡º â†’ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼è¡¨ç¤º

#### ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£
- [ ] WCAG AAA ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆæ¯” (7:1+)
- [ ] ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒªãƒ³ã‚°è¡¨ç¤º (`ring-blue-500`)
- [ ] `@media (prefers-reduced-motion: reduce)` å¯¾å¿œ
````

---

## ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 6: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šç¾© (v3.0 æ–°è¦)

> **ç›®çš„**: AI ãŒä¸€è²«ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¼ãƒãƒ¼ãƒŸãƒ³ã‚°ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«
> **SSOT**: `src/shared/constants/messages.ts` (æ—¥æœ¬èªå°‚ç”¨)

````markdown
### 6. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šç¾©

> **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**: `src/shared/constants/messages.ts` (æ—¥æœ¬èªå°‚ç”¨)
> æ–°ã‚­ãƒ¼ã¯å¿…ãš **messages.ts ã«å…ˆã«è¿½åŠ **

#### 6.1 Message Key Naming Convention

| ãƒ‘ã‚¿ãƒ¼ãƒ³         | å½¢å¼                       | ä¾‹ç¤º                         |
| ---------------- | -------------------------- | ---------------------------- |
| ç”»é¢ã‚¿ã‚¤ãƒˆãƒ«     | `{screen}_title`           | `code_input_title`           |
| ãƒœã‚¿ãƒ³ãƒ©ãƒ™ãƒ«     | `{screen}_{action}_button` | `code_input_submit_button`   |
| å…¥åŠ›ãƒ’ãƒ³ãƒˆ       | `{screen}_{field}_hint`    | `code_input_code_hint`       |
| ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | `error_{type}`             | `error_network_offline`      |
| ç©ºçŠ¶æ…‹           | `{screen}_empty_{reason}`  | `code_input_empty_no_result` |

#### 6.2 Required Keys (ã“ã®æ©Ÿèƒ½ç”¨)

| ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¼               | å€¤ (æ—¥æœ¬èª)                | å‚™è€ƒ         |
| ---------------------------- | -------------------------- | ------------ |
| `code_input_title`           | "ã‚³ãƒ¼ãƒ‰å…¥åŠ›"               | ç”»é¢ã‚¿ã‚¤ãƒˆãƒ« |
| `code_input_submit_button`   | "åˆ†æã™ã‚‹"                 | é€ä¿¡ãƒœã‚¿ãƒ³   |
| `code_input_code_hint`       | "ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„" | å…¥åŠ›ãƒ’ãƒ³ãƒˆ   |
| `code_input_empty_no_result` | "åˆ†æçµæœãŒã‚ã‚Šã¾ã›ã‚“"     | ç©ºçŠ¶æ…‹       |
| `error_analysis_failed`      | "åˆ†æã«å¤±æ•—ã—ã¾ã—ãŸ"       | ã‚¨ãƒ©ãƒ¼       |

#### 6.3 Placeholder Usage

```typescript
// messages.ts ã§ã®å®šç¾©ä¾‹
export const MESSAGES = {
  code_input_count: (count: number) => `${count}ä»¶ã®çµæœ`,
} as const;
```
````

````

**ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šç¾©ä½œæˆåŸå‰‡**:
- **æ—¥æœ¬èªå°‚ç”¨**: `messages.ts` ãŒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- ã‚­ãƒ¼ãƒãƒ¼ãƒŸãƒ³ã‚°ã¯ä¸€è²«ã—ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ä½¿ç”¨
- Placeholder ã¯é–¢æ•°å½¢å¼ã§å®šç¾©

---

## ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 7: å¤‰æ›´å±¥æ­´ (å¿…é ˆ)

```markdown
### 7. å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ | æ ¹æ‹  |
|------|-----------|---------|------|
| 2026-02-11 | v1.0 | åˆç¨¿ä½œæˆ | CONTEXT åŸºç›¤ |
````

---

## ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ: SPEC ä½œæˆå®Œäº†å‰ç¢ºèª (v3.6 ç°¡ç´ åŒ–)

### å¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³å®Œå…¨æ€§

- [ ] **Â§0.0 Project Context**: ãƒãƒ¼ãƒŸãƒ³ã‚°è¦å‰‡ + glossary å‚ç…§
- [ ] **Â§0.1 Target Files**: Glob ãƒ‘ã‚¿ãƒ¼ãƒ³ã€æ¡ä»¶ä»˜ããƒ•ã‚¡ã‚¤ãƒ«æ¡ä»¶æ˜ç¤º
- [ ] **Â§0.2.1 Core State**: æ ¸å¿ƒçŠ¶æ…‹è¦ç´ ã€çŠ¶æ…‹ enum å®šç¾©
- [ ] **Â§0.2.2 Architecture Guidance**: Hook/API åˆ†é›¢åŸºæº–ã€ãƒãƒ¼ãƒŸãƒ³ã‚°è¦å‰‡
- [ ] **Â§0.2.3 State Transitions**: çŠ¶æ…‹ä¸€è¦§ + é·ç§»ãƒ†ãƒ¼ãƒ–ãƒ«
- [ ] **Â§0.3 Error Handling**: ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—åˆ¥å‡¦ç†ãƒãƒªã‚·ãƒ¼
- [ ] **Â§0.4.1 Zod ã‚¹ã‚­ãƒ¼ãƒ**: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰/å‹/nullable å®šç¾©
- [ ] **Â§0.5 API Contract**: Request/Response Schema, Error Codes (ã¾ãŸã¯ N/A)
- [ ] **Â§0.6 NFR**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™ã€AI ã‚³ã‚¹ãƒˆä¸Šé™ (è©²å½“æ™‚)
- [ ] **Â§0.7 AI Logic & Prompts**: System Prompt, Response Schema (AI æ©Ÿèƒ½æ™‚)
- [ ] **Â§0.8 Safety & Guardrails**: å…¥å‡ºåŠ›æ¤œè¨¼ã€Rate Limiting (AI æ©Ÿèƒ½æ™‚)
- [ ] **Â§0.9 Design Tokens**: ä½¿ç”¨ã™ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã€å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### æ¦‚è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³

- [ ] **Â§1.4 Goals / Non-Goals**: ç¯„å›²æ˜ç¢ºåŒ–
- [ ] **Â§1.5 Screen Flow**: ç”»é¢é·ç§» (ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã¾ãŸã¯ãƒ†ãƒ¼ãƒ–ãƒ«)

### æ©Ÿèƒ½è¦æ±‚äº‹é …

- [ ] ã™ã¹ã¦ã® FR ã« **BDD 5-column AC** å­˜åœ¨ (Given/When/Then/è¦³æ¸¬ç‚¹)
- [ ] ã™ã¹ã¦ã® FR ã« **Exception Flows (EF)** ãƒ†ãƒ¼ãƒ–ãƒ«å­˜åœ¨
- [ ] **Â§2.X Business Rules**: è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ pseudocode
- [ ] CONTEXT ã® Success Criteria ãŒ FR ã® AC ã§ã‚«ãƒãƒ¼ã•ã‚Œã¦ã„ã‚‹

### æ¤œè¨¼ & ãƒ†ã‚¹ãƒˆ

- [ ] **Â§5.1 Test Scenarios**: æ­£å¸¸/ç©º/ã‚¨ãƒ©ãƒ¼ã‚·ãƒŠãƒªã‚ªä¸€è¦§
- [ ] **Â§5.2 Acceptance Checklist**: æ‰‹å‹•æ¤œè¨¼é …ç›®

### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šç¾©

- [ ] **Â§6 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šç¾©**: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¼ä¸€è¦§ (æ—¥æœ¬èª)

### ä¸€èˆ¬ãƒ«ãƒ¼ãƒ«

- [ ] ç©ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ãªã— (è©²å½“ãªã—ãªã‚‰ "N/A" æ˜ç¤º)
- [ ] SSOT å‚ç…§ãƒ‘ã‚¹æ­£ç¢º

---

## MVS (Minimum Viable SPEC) ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

> **ç”¨é€”**: AI ãŒå®Ÿè£…é–‹å§‹å‰ã« SPEC å®Œå…¨æ€§ã‚’ç´ æ—©ãæ¤œè¨¼

### ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®æ˜ç¢ºæ€§

- [ ] Target Files ã® Glob ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¥ã«æ˜ç¤º
- [ ] æ¡ä»¶ä»˜ããƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒˆãƒªã‚¬ãƒ¼æ¡ä»¶æ˜ç¤º

### ç”¨èªæ˜ç¢ºæ€§

- [ ] æ›–æ˜§ãªç”¨èªãªã— (glossary.md å‚ç…§)
- [ ] ã‚³ãƒ¼ãƒ‰è¡¨ç¾æ˜ç¤º (å‹åã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å)

### çŠ¶æ…‹æ˜ç¢ºæ€§

- [ ] çŠ¶æ…‹ä¸€è¦§ã¨é·ç§»ãƒ†ãƒ¼ãƒ–ãƒ«å­˜åœ¨
- [ ] ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹å‡¦ç†æ˜ç¤º

### ãƒ‡ãƒ¼ã‚¿æ˜ç¢ºæ€§

- [ ] Zod ã‚¹ã‚­ãƒ¼ãƒå®šç¾©æ¸ˆã¿ (ã¾ãŸã¯ N/A)
- [ ] API ã‚¹ã‚­ãƒ¼ãƒå®šç¾©æ¸ˆã¿ (ã¾ãŸã¯ N/A)
- [ ] ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªå®šç¾©æ¸ˆã¿

### ãƒ­ã‚¸ãƒƒã‚¯æ˜ç¢ºæ€§

- [ ] è¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒ pseudocode ã§æ˜ç¤º
- [ ] Edge case ã¨ Exception flow æ˜ç¤º

### UI/UX æ˜ç¢ºæ€§

- [ ] ç”»é¢ãƒ•ãƒ­ãƒ¼æ˜ç¤º
- [ ] ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¼å®šç¾©æ¸ˆã¿
